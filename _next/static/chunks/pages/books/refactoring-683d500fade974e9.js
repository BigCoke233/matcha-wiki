(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[867],{391:function(e,s,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/books/refactoring",function(){return n(9894)}])},7715:function(e,s,n){"use strict";n.d(s,{Z:function(){return d}});var r=n(5893);n(7294);let l="My detailed reading notes from computer science books",i="/reading-notes";var o=n(1163),t=n(5675),a=n.n(t);let c={logo:(0,r.jsx)(function(){return(0,r.jsx)(a(),{src:"".concat(i,"/logo.png"),alt:"Reading notes homepage",width:30,height:30})},{}),project:{link:"https://github.com/mkrtchian/reading-notes"},docsRepositoryBase:"https://github.com/mkrtchian/reading-notes/blob/main",footer:{text:"Made by Roman Mkrtchian"},head:function(){let e="Reading notes";return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("meta",{name:"msapplication-TileColor",content:"#fff"}),(0,r.jsx)("meta",{httpEquiv:"Content-Language",content:"en"}),(0,r.jsx)("meta",{name:"description",content:l}),(0,r.jsx)("meta",{property:"og:title",content:e}),(0,r.jsx)("meta",{property:"og:description",content:l}),(0,r.jsx)("meta",{name:"apple-mobile-web-app-title",content:e}),(0,r.jsx)("link",{rel:"icon",type:"image/x-icon",href:"".concat(i,"/favicon.ico")})]})},feedback:{content:()=>(0,r.jsx)(r.Fragment,{children:"Question? Give me feedback →"}),labels:"feedback"},useNextSeoProps:function(){let{route:e}=(0,o.useRouter)(),s={description:l};return"/"!==e?s.titleTemplate="%s – Reading notes":s.titleTemplate="%s",s},i18n:[]};var d=c},9894:function(e,s,n){"use strict";n.r(s),n.d(s,{default:function(){return d.Z}});var r,l,i,o=n(5893),t=n(7715);n(5513);var a=n(6528),c=n(1151);n(5675);var d=n(8524);let h={filePath:"pages/books/refactoring.md",route:"/books/refactoring",frontMatter:{},pageMap:[{kind:"Meta",data:{index:"Introduction",books:"Reading notes"}},{kind:"Folder",name:"books",route:"/books",children:[{kind:"Meta",data:{"designing-data-intensive-applications":"Designing Data-Intensive Applications","get-your-hands-dirty-on-clean-architecture":"Get Your Hands Dirty on Clean Architecture","the-design-of-web-apis":"The Design of Web APIs","unit-testing":"Unit Testing: Principles, Practices, and Patterns","learning-domain-driven-design":"Learning Domain-Driven Design","continuous-discovery-habits":"Continuous Discovery Habits",refactoring:"Refactoring: Improving the Design of Existing Code"}},{kind:"MdxPage",name:"continuous-discovery-habits",route:"/books/continuous-discovery-habits"},{kind:"MdxPage",name:"designing-data-intensive-applications",route:"/books/designing-data-intensive-applications"},{kind:"MdxPage",name:"get-your-hands-dirty-on-clean-architecture",route:"/books/get-your-hands-dirty-on-clean-architecture"},{kind:"MdxPage",name:"learning-domain-driven-design",route:"/books/learning-domain-driven-design"},{kind:"MdxPage",name:"refactoring",route:"/books/refactoring"},{kind:"MdxPage",name:"the-design-of-web-apis",route:"/books/the-design-of-web-apis"},{kind:"MdxPage",name:"unit-testing",route:"/books/unit-testing"}]},{kind:"MdxPage",name:"index",route:"/"}],headings:[{depth:1,value:"Refactoring: Improving the Design of Existing Code"},{depth:2,value:"1 - Refactoring : exemple introductif"},{depth:2,value:"2 - Principes du refactoring"},{depth:2,value:"3 - Quand le code sent mauvais"},{depth:2,value:"4 - Cr\xe9ation de tests"},{depth:2,value:"5 - Pr\xe9sentation du catalogue"},{depth:2,value:"6 - Premier ensemble de refactorings"},{depth:3,value:"Extract Function"},{depth:3,value:"Inline Function"},{depth:3,value:"Extract Variable"}],flexsearch:{codeblocks:!0}},x=Symbol.for("__nextra_internal__"),p=(r=globalThis)[x]||(r[x]=Object.create(null));p.pageMap=h.pageMap,p.route=h.route,(l=p).context||(l.context=Object.create(null)),(i=p).refreshListeners||(i.refreshListeners=Object.create(null)),p.Layout=a.ZP;let j="Refactoring: Improving the Design of Existing Code";function u(e){let s=Object.assign({h1:"h1",h2:"h2",ul:"ul",li:"li",p:"p",em:"em",div:"div",pre:"pre",code:"code",span:"span",strong:"strong",a:"a",h3:"h3",ol:"ol"},(0,c.ah)(),e.components);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(s.h1,{children:"Refactoring: Improving the Design of Existing Code"}),"\n",(0,o.jsx)(s.h2,{id:"1---refactoring--exemple-introductif",children:"1 - Refactoring : exemple introductif"}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsx)(s.p,{children:"Ce chapitre montre un exemple de refactoring selon les techniques qui seront d\xe9crites dans le livre."}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsx)(s.p,{children:"Description :"}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"Le logiciel sert une entreprise de vente de billets de pi\xe8ces de th\xe9\xe2tre, et permet de cr\xe9er des factures."}),"\n",(0,o.jsx)(s.li,{children:"Les clients pourront avoir des rabais en fonction de divers param\xe8tres (par exemple le type de la pi\xe8ce)."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsx)(s.p,{children:"Le programme :"}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsx)(s.p,{children:"On a deux objets/json auxquels notre fonction a acc\xe8s :"}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["Les ",(0,o.jsx)(s.em,{children:"plays"})," qui sont les pi\xe8ces de th\xe9\xe2tre.\nExemple :","\n",(0,o.jsx)(s.div,{"data-rehype-pretty-code-fragment":"",children:(0,o.jsx)(s.pre,{"data-language":"json","data-theme":"default",children:(0,o.jsxs)(s.code,{"data-language":"json","data-theme":"default",children:[(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"{"})}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:'"hamlet"'}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" { "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:'"name"'}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Hamlet"'}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:'"type"'}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"tragedy"'}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" }"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:'"othello"'}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" { "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:'"name"'}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Othello"'}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:'"type"'}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"tragedy"'}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" }"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})})}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["Les ",(0,o.jsx)(s.em,{children:"invoices"})," qui sont","\n",(0,o.jsx)(s.div,{"data-rehype-pretty-code-fragment":"",children:(0,o.jsx)(s.pre,{"data-language":"json","data-theme":"default",children:(0,o.jsxs)(s.code,{"data-language":"json","data-theme":"default",children:[(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"{"})}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:'"customer"'}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"BigCo"'}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:'"performances"'}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ["})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    {"})}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:'"playID"'}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"hamlet"'}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:'"audience"'}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"55"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    {"})}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:'"playID"'}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"othello"'}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:'"audience"'}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"40"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  ]"})}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsx)(s.p,{children:"Le code initial est le suivant :"}),"\n",(0,o.jsx)(s.div,{"data-rehype-pretty-code-fragment":"",children:(0,o.jsx)(s.pre,{"data-language":"typescript","data-theme":"default",children:(0,o.jsxs)(s.code,{"data-language":"typescript","data-theme":"default",children:[(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"statement"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(invoice"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" plays) {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"let"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" totalAmount "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"let"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" volumeCredits "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"let"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" result "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"`Statement for "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"${"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"invoice"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".customer"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"}"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"\\n`"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"format"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"new"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"Intl"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".NumberFormat"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"en-US"'}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    style"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"currency"'}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    currency"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"USD"'}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    minimumFractionDigits"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"2"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  }).format;"})}),"\n",(0,o.jsx)(s.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"for"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ("}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"let"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" perf "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"of"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"invoice"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".performances) {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"play"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" plays["}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"perf"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".playID];"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"let"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" thisAmount "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"switch"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ("}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"play"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".type) {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"case"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"tragedy"'}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:":"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        thisAmount "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"40000"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ("}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"perf"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".audience "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:">"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"30"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:") {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"          thisAmount "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"+="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"1000"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"*"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ("}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"perf"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".audience "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"-"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"30"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:");"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        }"})}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"break"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"case"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"comedy"'}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:":"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        thisAmount "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"30000"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ("}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"perf"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".audience "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:">"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"20"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:") {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"          thisAmount "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"+="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"10000"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"+"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"500"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"*"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ("}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"perf"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".audience "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"-"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"20"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:");"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        }"})}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        thisAmount "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"+="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"300"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"*"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"perf"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".audience;"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"break"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"default"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:":"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"throw"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"new"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"Error"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"`unknown type: "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"${"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"play"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".type"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"}"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"`"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:");"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// add volume credits"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    volumeCredits "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"+="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"Math"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".max"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"perf"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".audience "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"-"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"30"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:");"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// add extra credit for every ten comedy attendees"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ("}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"comedy"'}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"==="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"play"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".type)"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"      volumeCredits "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"+="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"Math"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".floor"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"perf"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".audience "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"/"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"5"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:");"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// print line for this order"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    result "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"+="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"` "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"${"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"play"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".name"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"}"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:": "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"${"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"format"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(thisAmount "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"/"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"100"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:")"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"}"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"`"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    result "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"+="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"` ("}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"${"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"perf"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".audience"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"}"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" seats)\\n`"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    totalAmount "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"+="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" thisAmount;"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  }"})}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  result "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"+="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"`Amount owed is "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"${"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"format"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(totalAmount "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"/"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"100"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:")"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"}"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"\\n`"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  result "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"+="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"`You earned "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"${"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"volumeCredits"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"}"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" credits\\n`"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" result;"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})})}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"Le programme est court pour les besoins du livre. Pour un si petit programme la question ne se poserait peut-\xeatre pas, mais pour un programme de plusieurs centaines de lignes, il faut refactorer."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsx)(s.p,{children:"Les utilisateurs veulent deux modifications :"}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"1- Afficher un relev\xe9 de compte en HTML et pas seulement sous format texte comme actuellement."}),"\n",(0,o.jsx)(s.li,{children:"2- Ajouter de nouveaux types de pi\xe8ces de th\xe9\xe2tre, avec chacune ses r\xe8gles particuli\xe8res pour le syst\xe8me de rabais. On ne sait pas encore quels types on voudra."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsx)(s.p,{children:"Une premi\xe8re (mauvaise) solution simple serait de dupliquer la fonction pour faire la version HTML sur l’autre fonction."}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"Mais il faudrait ensuite mettre \xe0 jour les r\xe8gles des nouveaux types de pi\xe8ces sur les deux fonctions."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:["On va ",(0,o.jsx)(s.strong,{children:"refactorer"})," le programme :"]}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsx)(s.p,{children:(0,o.jsx)(s.strong,{children:"1 - Les tests"})}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"Avant tout refactoring, la 1\xe8re chose \xe0 faire c’est de s’assurer que cette partie du code a des tests solides. Si c’est pas le cas on les \xe9crit."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsx)(s.p,{children:(0,o.jsx)(s.strong,{children:"2 - On d\xe9compose la fonction en sortant le switch"})}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["On identifie d’abord \xe0 l'œil les ",(0,o.jsx)(s.strong,{children:"parties qui vont ensemble"}),"."]}),"\n",(0,o.jsx)(s.li,{children:"Ici c’est d’abord le switch qu’on choisit de traiter comme un bloc."}),"\n",(0,o.jsxs)(s.li,{children:["On va utiliser la technique ",(0,o.jsx)(s.strong,{children:(0,o.jsx)(s.a,{href:"#extract-function",children:"Extract Function"})})," pour sortir le bloc dans une autre fonction (qui se trouvera dans la port\xe9e de ",(0,o.jsx)(s.em,{children:"statement"}),")."]}),"\n",(0,o.jsxs)(s.li,{children:["On regarde d’abord les ",(0,o.jsx)(s.strong,{children:"variables qui sont utilis\xe9es"})," par la nouvelle fonction extraite :","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["Deux variables ne sont que lues (",(0,o.jsx)(s.em,{children:"invoices"})," et ",(0,o.jsx)(s.em,{children:"plays"}),"), on va pouvoir les passer en param\xe8tre."]}),"\n",(0,o.jsxs)(s.li,{children:["Une autre variable est assign\xe9e (",(0,o.jsx)(s.em,{children:"thisAmount"}),"), on va pouvoir retourner la valeur pour l’assigner par retour de fonction."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["Une fois qu’on a d\xe9plac\xe9 la fonction, on compile (si n\xe9cessaire), on joue les tests, et on commit.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["Pour \xe9viter de passer du temps \xe0 d\xe9bugger son propre refactoring, il faut faire de ",(0,o.jsx)(s.strong,{children:"petites \xe9tapes avec un commit \xe0 chaque fois"}),"."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["On va ensuite renommer la fonction, et ses param\xe8tres :","\n",(0,o.jsx)(s.div,{"data-rehype-pretty-code-fragment":"",children:(0,o.jsx)(s.pre,{"data-language":"typescript","data-theme":"default",children:(0,o.jsxs)(s.code,{"data-language":"typescript","data-theme":"default",children:[(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"amountFor"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(aPerformance"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" play) {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// …"})]})]})})}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["Le fait de mettre ",(0,o.jsx)(s.em,{children:"For"})," dans le nom de la fonction et ",(0,o.jsx)(s.em,{children:"a"})," dans le nom du param\xe8tre fait partie du style de Fowler, qu’il a pris \xe0 Kent Beck."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsx)(s.p,{children:(0,o.jsx)(s.strong,{children:"3 - On supprime la variable play"})}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["Pour chaque variable prise en param\xe8tre de notre nouvelle fonction ",(0,o.jsx)(s.em,{children:"amountFor"}),", on v\xe9rifie sa provenance pour voir si on ne peut pas s’en d\xe9barrasser :","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.em,{children:"aPerformance"})," est diff\xe9rente \xe0 chaque tour de boucle, on doit la garder."]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.em,{children:"play"})," est par contre toujours le m\xeame : on pourrait le supprimer comme param\xe8tre, et recalculer sa valeur dans notre nouvelle fonction."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["On va utiliser la technique ",(0,o.jsx)(s.strong,{children:"Replace Temp with Query"})," pour remplacer dans la boucle :","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:(0,o.jsx)(s.code,{children:"const play = plays[perf.playID];"})}),"\n",(0,o.jsx)(s.li,{children:"par"}),"\n",(0,o.jsx)(s.li,{children:(0,o.jsx)(s.code,{children:"const play = playFor(perf);"})}),"\n",(0,o.jsxs)(s.li,{children:["Avec la nouvelle fonction :","\n",(0,o.jsx)(s.div,{"data-rehype-pretty-code-fragment":"",children:(0,o.jsx)(s.pre,{"data-language":"typescript","data-theme":"default",children:(0,o.jsxs)(s.code,{"data-language":"typescript","data-theme":"default",children:[(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"playFor"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(aPerformance) {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" plays["}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"aPerformance"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".playID];"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["On compile, teste, commit, puis on utilise ",(0,o.jsx)(s.strong,{children:"Inline Variable"})," :","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["On supprime la variable ",(0,o.jsx)(s.code,{children:"const play = playFor(perf);"})]}),"\n",(0,o.jsxs)(s.li,{children:["Et on appelle la fonction au moment d’appeler ",(0,o.jsx)(s.em,{children:"amountFor"})," :","\n",(0,o.jsx)(s.div,{"data-rehype-pretty-code-fragment":"",children:(0,o.jsx)(s.pre,{"data-language":"typescript","data-theme":"default",children:(0,o.jsx)(s.code,{"data-language":"typescript","data-theme":"default",children:(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"let"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" thisAmount "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"amountFor"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(perf"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"palyFor"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(perf));"})]})})})}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["Et on fait le remplacement par l’appel partout o\xf9 ",(0,o.jsx)(s.em,{children:"play"})," \xe9tait utilis\xe9."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["On compile, teste, commit, puis on peut utiliser ",(0,o.jsx)(s.strong,{children:"Change Function Declaration"})," pour \xe9liminer le param\xe8tre ",(0,o.jsx)(s.em,{children:"play"})," dans ",(0,o.jsx)(s.em,{children:"amountFor"})," :","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["On utilise la nouvelle fonction ",(0,o.jsx)(s.em,{children:"playFor"})," \xe0 l’int\xe9rieur d’",(0,o.jsx)(s.em,{children:"amountFor"}),", en remplacement du param\xe8tre ",(0,o.jsx)(s.em,{children:"play"}),"."]}),"\n",(0,o.jsx)(s.li,{children:"On compile, teste, commit."}),"\n",(0,o.jsxs)(s.li,{children:["On supprime le param\xe8tre ",(0,o.jsx)(s.em,{children:"play"})," qui n’\xe9tait plus utilis\xe9."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["Remarques :","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["Faire 3 fois l’acc\xe8s \xe0 play est moins performant que de mettre la valeur dans une variable et y acc\xe9der les deux autres fois.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["Mais ",(0,o.jsx)(s.strong,{children:"cette diff\xe9rence est n\xe9gligeable"}),"."]}),"\n",(0,o.jsxs)(s.li,{children:["Et ",(0,o.jsx)(s.strong,{children:"m\xeame si elle \xe9tait significative"}),", rendre le code plus clair permettra de mieux l’optimiser ensuite."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"Supprimer les variables locales"})," permet en g\xe9n\xe9ral de faciliter les extractions, c’est pour \xe7a qu’on le fait."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["On utilise encore ",(0,o.jsx)(s.strong,{children:"Inline Variable"})," pour appeler plusieurs fois ",(0,o.jsx)(s.em,{children:"amountFor"})," dans ",(0,o.jsx)(s.em,{children:"statement"}),", comme \xe7a on supprime cette variable locale aussi."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsx)(s.p,{children:(0,o.jsx)(s.strong,{children:"4 - on extrait les cr\xe9dits de volume"})}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["On va extraire le bloc de calcul de cr\xe9dits de volume. Pour \xe7a on v\xe9rifie les variables qui devront \xeatre pass\xe9es :","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.em,{children:"perf"})," doit \xeatre pass\xe9."]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.em,{children:"play"})," a \xe9t\xe9 supprim\xe9 par le refactoring d’avant."]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.em,{children:"volumeCredits"})," est un accumulateur. On peut cr\xe9er une variable locale dans la nouvelle fonction et la retourner."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["Ca donne :","\n",(0,o.jsx)(s.div,{"data-rehype-pretty-code-fragment":"",children:(0,o.jsx)(s.pre,{"data-language":"typescript","data-theme":"default",children:(0,o.jsxs)(s.code,{"data-language":"typescript","data-theme":"default",children:[(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"volumeCreditsFor"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(perf) {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"let"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" volumeCredits "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  volumeCredits "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"+="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"Math"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".max"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"perf"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".audience "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"-"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"30"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:");"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ("}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"comedy"'}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"==="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"playFor"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(perf).type)"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    volumeCredits "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"+="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"Math"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".floor"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"perf"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".audience "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"/"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"5"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:");"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" volumeCredits;"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})})}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["Et c\xf4t\xe9 appel dans ",(0,o.jsx)(s.em,{children:"statement"})," :\n",(0,o.jsx)(s.code,{children:"volumeCredits += volumeCreditsFor(perf);"})]}),"\n",(0,o.jsx)(s.li,{children:"On compile, teste, commit."}),"\n",(0,o.jsxs)(s.li,{children:["On va renommer les variables dans ",(0,o.jsx)(s.em,{children:"volumeCreditsFor"})," :","\n",(0,o.jsx)(s.div,{"data-rehype-pretty-code-fragment":"",children:(0,o.jsx)(s.pre,{"data-language":"typescript","data-theme":"default",children:(0,o.jsxs)(s.code,{"data-language":"typescript","data-theme":"default",children:[(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"volumeCreditsFor"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(aPerformance) {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"let"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" result "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  result "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"+="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"Math"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".max"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"aPerformance"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".audience "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"-"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"30"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:");"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ("}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"comedy"'}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"==="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"playFor"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(aPerformance).type)"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    result "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"+="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"Math"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".floor"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"aPerformance"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".audience "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"/"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"5"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:");"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" result;"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})})}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["On a ici fait deux changements de variable (",(0,o.jsx)(s.em,{children:"aPerformance"}),", et ",(0,o.jsx)(s.em,{children:"result"}),"), il faut compiler, tester et commiter entre chaque changement."]}),"\n",(0,o.jsxs)(s.li,{children:["La convention ",(0,o.jsx)(s.em,{children:"result"})," fait partie du style de convention de Martin Fowler, au m\xeame titre que ",(0,o.jsx)(s.em,{children:"aVariable"})," pour les variables en param\xe8tre."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsx)(s.p,{children:(0,o.jsx)(s.strong,{children:"5 - On va supprimer la variable format"})}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["On continue \xe0 supprimer des variables temporaires dans ",(0,o.jsx)(s.em,{children:"statement"})," pour faciliter l’extraction de blocs."]}),"\n",(0,o.jsxs)(s.li,{children:["Ici on s’attaque \xe0 ",(0,o.jsx)(s.em,{children:"format"}),", c’est une variable contenant une fonction. On va la supprimer pour d\xe9clarer la fonction en question :","\n",(0,o.jsx)(s.div,{"data-rehype-pretty-code-fragment":"",children:(0,o.jsx)(s.pre,{"data-language":"typescript","data-theme":"default",children:(0,o.jsxs)(s.code,{"data-language":"typescript","data-theme":"default",children:[(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"format"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(aNumber) {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"new"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"Intl"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".NumberFormat"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"en-US"'}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    style"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"currency"'}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    currency"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"USD"'}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    minimumFractionDigits"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"2"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  })"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".format"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(aNumber);"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})})}),"\n"]}),"\n",(0,o.jsx)(s.li,{children:"Cette technique de transformer une fonction dans une variable en fonction d\xe9clar\xe9e n’est pas assez importante pour figurer dans les techniques du livre."}),"\n",(0,o.jsxs)(s.li,{children:["On va ensuite utiliser ",(0,o.jsx)(s.strong,{children:"Change Function Declaration"})," pour renommer la fonction en quelque chose qui indique mieux ce qu’elle fait.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["Vu qu’elle est utilis\xe9e dans une petite port\xe9e et est peu importante, Fowler privil\xe9gie un nom plus court que ",(0,o.jsx)(s.em,{children:"formatAsUSD"}),". Il choisit juste ",(0,o.jsx)(s.em,{children:"usd"})," pour mettre en avant l’aspect mon\xe9taire."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsx)(s.p,{children:(0,o.jsx)(s.strong,{children:"6 - On va d\xe9placer le calcul du volume de cr\xe9dits"})}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["On avait pr\xe9c\xe9demment extrait le calcul du volume de cr\xe9dits pour une pi\xe8ce. On va maintenant extraire le calcul du volume de cr\xe9dits pour l’ensemble des pi\xe8ces hors de ",(0,o.jsx)(s.em,{children:"statement"}),"."]}),"\n",(0,o.jsxs)(s.li,{children:["On va utiliser ",(0,o.jsx)(s.strong,{children:"Split Loop"})," pour couper la boucle en deux, et avoir le calcul du volume de cr\xe9dits dans une boucle \xe0 part.","\n",(0,o.jsx)(s.div,{"data-rehype-pretty-code-fragment":"",children:(0,o.jsx)(s.pre,{"data-language":"typescript","data-theme":"default",children:(0,o.jsxs)(s.code,{"data-language":"typescript","data-theme":"default",children:[(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"for"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ("}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"let"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" perf "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"of"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"invoice"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".performances) {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// print line for this order"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  result "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"+="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"` "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"${"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"play"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".name"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"}"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:": "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"${"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"format"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(thisAmount "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"/"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"100"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:")"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"}"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"`"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  result "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"+="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"` ("}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"${"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"perf"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".audience"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"}"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" seats)\\n`"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  totalAmount "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"+="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" thisAmount;"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"for"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ("}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"let"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" perf "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"of"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"invoice"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".performances) {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  volumeCredits "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"+="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"volumeCreditsFor"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(perf);"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})})}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"On compile, teste, commit."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["On peut alors utiliser ",(0,o.jsx)(s.strong,{children:"Slide Statements"})," pour d\xe9placer la d\xe9claration de la variable ",(0,o.jsx)(s.em,{children:"volumeCredits"})," juste au-dessus de la 2\xe8me boucle.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"On compile, teste, commit."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["On va pouvoir utiliser ",(0,o.jsx)(s.strong,{children:"Replace Temp with Query"}),", la premi\xe8re \xe9tape pour pouvoir le faire c’est d’utiliser ",(0,o.jsx)(s.strong,{children:(0,o.jsx)(s.a,{href:"#extract-function",children:"Extract Function"})})," :","\n",(0,o.jsx)(s.div,{"data-rehype-pretty-code-fragment":"",children:(0,o.jsx)(s.pre,{"data-language":"typescript","data-theme":"default",children:(0,o.jsxs)(s.code,{"data-language":"typescript","data-theme":"default",children:[(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"totalVolumeCredits"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"() {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"let"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" volumeCredits "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"for"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ("}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"let"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" perf "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"of"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"invoice"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".performances) {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    volumeCredits "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"+="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"volumeCreditsFor"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(perf);"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  }"})}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" volumeCredits;"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})})}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["On peut donc appeler la nouvelle fonction dans statement :","\n",(0,o.jsx)(s.div,{"data-rehype-pretty-code-fragment":"",children:(0,o.jsx)(s.pre,{"data-language":"typescript","data-theme":"default",children:(0,o.jsx)(s.code,{"data-language":"typescript","data-theme":"default",children:(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"volumeCredits "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"totalVolumeCredits"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"();"})]})})})}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"On compile, teste, commit."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["On peut alors utiliser ",(0,o.jsx)(s.strong,{children:"Inline Variable"})," pour supprimer la variable locale ",(0,o.jsx)(s.em,{children:"volumeCredits"}),", et appeler ",(0,o.jsx)(s.em,{children:"totalVolumeCredits"})," l\xe0 o\xf9 elle \xe9tait utilis\xe9e.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"On compile, teste, commit."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["Remarques :","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["Pour le c\xf4t\xe9 ",(0,o.jsx)(s.strong,{children:"performance"}),", la plupart du temps cr\xe9er des boucles suppl\xe9mentaires ne cr\xe9era pas de ralentissement significatif.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"M\xeame dans les rares cas o\xf9 c’est le cas, on pourra toujours mieux optimiser apr\xe8s avoir rendu le code plus clair par du refactoring."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["Les \xe9tapes pr\xe9sent\xe9es avant chaque compilation/test/commit sont tr\xe8s courtes. Il arrive \xe0 Martin Fowler de ne pas faire \xe0 chaque fois des \xe9tapes aussi courtes, mais il fait quand m\xeame des \xe9tapes relativement courtes.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["Et surtout, d\xe8s que les tests \xe9chouent, il ",(0,o.jsx)(s.strong,{children:"annule ce qu’il a fait depuis le dernier commit"})," et reprend avec des \xe9tapes plus courtes (comme celles-l\xe0)."]}),"\n",(0,o.jsxs)(s.li,{children:["Le but c’est de ne pas ",(0,o.jsx)(s.strong,{children:"perdre de temps \xe0 d\xe9bugger"})," pendant un refactoring."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["On va r\xe9p\xe9ter la m\xeame s\xe9quence pour extraire compl\xe8tement ",(0,o.jsx)(s.em,{children:"totalAmount"})," :","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"Split Loop"})," pour extraire l’instruction qui nous int\xe9resse dans une boucle \xe0 part."]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"Slide Statements"})," pour d\xe9placer la variable locale pr\xe8s de la nouvelle boucle."]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:(0,o.jsx)(s.a,{href:"#extract-function",children:"Extract Function"})})," pour extraire la boucle dans une nouvelle fonction.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["Le meilleur nom pour cette fonction est d\xe9j\xe0 pris par la variable ",(0,o.jsx)(s.em,{children:"totalAmount"}),", donc on lui met un nom au hasard pour garder un code qui marche et commiter."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"Inline Variable"})," nous permet d’\xe9liminer la variable locale, et de renommer la nouvelle fonction ",(0,o.jsx)(s.em,{children:"totalAmount"}),"."]}),"\n",(0,o.jsxs)(s.li,{children:["On en profite aussi pour renommer la variable locale dans la nouvelle fonction en ",(0,o.jsx)(s.em,{children:"result"})," pour respecter notre convention de nommage."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["Ca donne :","\n",(0,o.jsx)(s.div,{"data-rehype-pretty-code-fragment":"",children:(0,o.jsx)(s.pre,{"data-language":"typescript","data-theme":"default",children:(0,o.jsxs)(s.code,{"data-language":"typescript","data-theme":"default",children:[(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"totalAmount"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"() {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"let"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" result "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"for"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ("}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"let"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" perf "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"of"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"invoice"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".performances) {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    result "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"+="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"amountFor"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(perf);"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  }"})}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" result;"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsx)(s.p,{children:(0,o.jsx)(s.strong,{children:"7 - On va fractionner les phases de calcul et de formatage"})}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsx)(s.p,{children:"Jusqu’ici on avait refactor\xe9 pour rendre le code plus clair et mieux le comprendre. On va maintenant le mener vers l’objectif qui est de pouvoir cr\xe9er des factures HTML en plus des factures texte."}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:["On va mettre en œuvre ",(0,o.jsx)(s.strong,{children:"Split Phase"})," pour faire la division logique / formatage."]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:["Pour \xe7a on commence par appliquer ",(0,o.jsx)(s.strong,{children:(0,o.jsx)(s.a,{href:"#extract-function",children:"Extract Function"})})," au code qui constituera la 2\xe8me phase : on va d\xe9placer l’ensemble du code de ",(0,o.jsx)(s.em,{children:"statement"})," et les fonctions imbriqu\xe9es dans une fonction ",(0,o.jsx)(s.em,{children:"renderPlainText"}),"."]}),"\n",(0,o.jsx)(s.div,{"data-rehype-pretty-code-fragment":"",children:(0,o.jsx)(s.pre,{"data-language":"typescript","data-theme":"default",children:(0,o.jsxs)(s.code,{"data-language":"typescript","data-theme":"default",children:[(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"statement"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(invoice"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" plays) {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"renderplainText"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(invoice"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" plays);"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n",(0,o.jsx)(s.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"renderPlainText"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(invoice"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" plays) {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"let"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" result "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"`Statement for "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"${"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"invoice"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".customer"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"}"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"\\n`"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// ..."})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" result;"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"totalAmount"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"() {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// ..."})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  }"})}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// ..."})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})})}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"On compile, teste et commit."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:["On va cr\xe9er un objet qui servira de ",(0,o.jsx)(s.strong,{children:"structure de donn\xe9es interm\xe9diaire entre les deux phases"})," :"]}),"\n",(0,o.jsx)(s.div,{"data-rehype-pretty-code-fragment":"",children:(0,o.jsx)(s.pre,{"data-language":"typescript","data-theme":"default",children:(0,o.jsxs)(s.code,{"data-language":"typescript","data-theme":"default",children:[(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"statement"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(invoice"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" plays) {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"statementData"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {};"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"renderplainText"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(statementData"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" invoice"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" plays);"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n",(0,o.jsx)(s.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"renderPlainText"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(data"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" invoice"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" plays) {"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"//..."})})]})})}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:["Le but c’est de d\xe9placer tout le calcul de logique hors de ",(0,o.jsx)(s.em,{children:"renderPlainText"}),", et de tout lui passer au travers de l’objet ",(0,o.jsx)(s.em,{children:"data"}),"."]}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsx)(s.p,{children:"(On va compiler / tester / commiter entre chaque \xe9tape)"}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:["On va mettre ",(0,o.jsx)(s.code,{children:"invoice.customer"})," dans ",(0,o.jsx)(s.em,{children:"data"}),", pour obtenir ",(0,o.jsx)(s.code,{children:"data.customer"})," de l’autre c\xf4t\xe9."]}),"\n",(0,o.jsx)(s.div,{"data-rehype-pretty-code-fragment":"",children:(0,o.jsx)(s.pre,{"data-language":"typescript","data-theme":"default",children:(0,o.jsxs)(s.code,{"data-language":"typescript","data-theme":"default",children:[(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"statementData"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {};"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"statementData"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".customer "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"invoice"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".customer;"})]})]})})}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:["On fait pareil avec ",(0,o.jsx)(s.code,{children:"invoice.performances"}),"."]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:["On veut maintenant que les valeurs des performances soient pr\xe9calcul\xe9es dans le param\xe8tre ",(0,o.jsx)(s.em,{children:"data"})," qu’on donne \xe0 ",(0,o.jsx)(s.em,{children:"renderPlainText"}),". On commence par cr\xe9er une fonction pour enrichir les performances :"]}),"\n",(0,o.jsx)(s.div,{"data-rehype-pretty-code-fragment":"",children:(0,o.jsx)(s.pre,{"data-language":"typescript","data-theme":"default",children:(0,o.jsxs)(s.code,{"data-language":"typescript","data-theme":"default",children:[(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"statementData"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".performances "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"invoice"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"."}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"performances"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".map"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(enrichPerformance);"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"enrichPerformance"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(aPerformance) {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"result"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" { "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"..."}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"aPerformance };"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" result;"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})})}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:["On va d\xe9placer les informations des pi\xe8ces (plays) dans les ",(0,o.jsx)(s.em,{children:"performances"})," qu’on a mis dans ",(0,o.jsx)(s.em,{children:"data"}),"."]}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["Pour \xe7a on ajoute la valeur dans notre nouvelle fonction.","\n",(0,o.jsx)(s.div,{"data-rehype-pretty-code-fragment":"",children:(0,o.jsx)(s.pre,{"data-language":"typescript","data-theme":"default",children:(0,o.jsxs)(s.code,{"data-language":"typescript","data-theme":"default",children:[(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"enrichPerformance"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(aPerformance) {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"result"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" { "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"..."}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"aPerformance };"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"result"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".play "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"playFor"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(result);"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" result;"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})})}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["Ensuite on utilise ",(0,o.jsx)(s.strong,{children:"Move Function"})," pour d\xe9placer ",(0,o.jsx)(s.em,{children:"playFor"})," en dessous d’",(0,o.jsx)(s.em,{children:"enrichPerformance"}),"."]}),"\n",(0,o.jsxs)(s.li,{children:["Et enfin on remplace toutes les utilisations de ",(0,o.jsx)(s.em,{children:"playFor"})," dans les fonctions de ",(0,o.jsx)(s.em,{children:"renderPlainText"})," par les valeurs pr\xe9calcul\xe9es issues de ",(0,o.jsx)(s.em,{children:"data"}),". On va y acc\xe9der typiquement par ",(0,o.jsx)(s.code,{children:"perf.play"}),"."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:["On va ensuite appliquer la m\xeame chose que pour ",(0,o.jsx)(s.em,{children:"playFor"}),", mais cette fois pour ",(0,o.jsx)(s.em,{children:"amountFor"})," dont on \xe9limine les appels de ",(0,o.jsx)(s.em,{children:"renderPlainText"}),"."]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:["Puis on fait la m\xeame chose pour ",(0,o.jsx)(s.em,{children:"volumeCreditsFor"}),"."]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:["Et encore la m\xeame chose pour ",(0,o.jsx)(s.em,{children:"totalAmount"}),", et ",(0,o.jsx)(s.em,{children:"totalVolumeCredits"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:["On en profite pour utiliser ",(0,o.jsx)(s.strong,{children:"Replace Loop with Pipeline"})," sur les boucles de ",(0,o.jsx)(s.em,{children:"totalAmount"})," et ",(0,o.jsx)(s.em,{children:"totalVolumeCredits"}),"."]}),"\n",(0,o.jsx)(s.div,{"data-rehype-pretty-code-fragment":"",children:(0,o.jsx)(s.pre,{"data-language":"typescript","data-theme":"default",children:(0,o.jsxs)(s.code,{"data-language":"typescript","data-theme":"default",children:[(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"totalAmount"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(data) {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"data"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"."}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"performances"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".reduce"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"((total"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" p) "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" total "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"+"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"p"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".amount"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:");"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})})}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsx)(s.p,{children:"On va maintenant extraire le code de premi\xe8re phase qu’on vient de cr\xe9er (la cr\xe9ation des data pr\xe9-calcul\xe9es dans statement) dans une fonction \xe0 part :"}),"\n",(0,o.jsx)(s.div,{"data-rehype-pretty-code-fragment":"",children:(0,o.jsx)(s.pre,{"data-language":"typescript","data-theme":"default",children:(0,o.jsxs)(s.code,{"data-language":"typescript","data-theme":"default",children:[(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"statement"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(invoice"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" plays) {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"renderplainText"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"createStatementData"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(invoice"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" plays)"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  );"})}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n",(0,o.jsx)(s.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"renderPlainText"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(data) {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"//..."})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n",(0,o.jsx)(s.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"createStatementData"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(invoice"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" plays) {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"result"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {};"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"result"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".customer "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"invoice"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".customer;"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"result"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".performances "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"invoice"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"."}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"performances"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".map"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(enrichPerformance);"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"result"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".totalAmount "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"totalAmount"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(result);"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"result"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".totalVolumeCredits "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"totalVolumeCredits"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(result);"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" result;"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"enrichPerformance"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(aPerformance) {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// ..."})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  }"})}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// ..."})})]})})}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:["On peut alors extraire ",(0,o.jsx)(s.em,{children:"createStatementData"})," et ses fonctions imbriqu\xe9es (le code de la phase 1 donc) dans un fichier \xe0 part qu’on appelle ",(0,o.jsx)(s.em,{children:"createStatementData.js"}),"."]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsx)(s.p,{children:"On peut maintenant facilement \xe9crire la version HTML de statement dans le fichier statement.js :"}),"\n",(0,o.jsx)(s.div,{"data-rehype-pretty-code-fragment":"",children:(0,o.jsx)(s.pre,{"data-language":"typescript","data-theme":"default",children:(0,o.jsxs)(s.code,{"data-language":"typescript","data-theme":"default",children:[(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"statement"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(invoice"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" plays) {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"renderplainText"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"createStatementData"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(invoice"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" plays));"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n",(0,o.jsx)(s.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"renderPlainText"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(data) {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"let"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" result "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"`Statement for "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"${"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"data"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".customer"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"}"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"\\n`"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// ..."})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" result;"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n",(0,o.jsx)(s.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"htmlStatement"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(invoice"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" plays) {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"renderHtml"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"createStatementData"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(invoice"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" plays));"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n",(0,o.jsx)(s.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"renderHtml"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(data) {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"let"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" result "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"`<h1>Statement for "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"${"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"data"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".customer"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"}"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"</h1>\\n`"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// ..."})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" result;"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})})}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:["Remarque : Fowler propose de suivre la ",(0,o.jsx)(s.strong,{children:"r\xe8gle du camping"})," : il faut toujours laisser le code un peu plus propre que l’\xe9tat dans lequel on l’a trouv\xe9. Le code ne sera jamais parfait, mais il sera meilleur qu’avant."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsx)(s.p,{children:(0,o.jsx)(s.strong,{children:"8 - On va cr\xe9er un calculateur pour types de performances"})}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsx)(s.p,{children:"On s’int\xe9resse ici au fait de faciliter l’ajout de nouveaux types de pi\xe8ces de th\xe9\xe2tre, avec chacun ses conditions et valeurs de calcul pour la facturation et les cr\xe9dits de volume."}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:["La solution qu’on retient c’est de cr\xe9er un calculateur sous forme de classes, avec des classes filles pour contenir la logique de chaque type de pi\xe8ce. On va donc mettre en œuvre la technique ",(0,o.jsx)(s.strong,{children:"Replace Conditional with Polymorphism"}),"."]}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["NDLR : dans Clean Code, Uncle Bob disait qu’un code proc\xe9dural (qui utilise les structures de donn\xe9es pour repr\xe9senter les objets) est adapt\xe9 pour ajouter des fonctionnalit\xe9s suppl\xe9mentaires (par exemple dans notre cas une fonctionnalit\xe9 en plus du calcul de facturation et du calcul de volume de cr\xe9dits). Un code orient\xe9 objet par contre est plut\xf4t adapt\xe9 pour l’ajout de nouveaux types d’objets sans ajout de nouvelles fonctionnalit\xe9s (par exemple dans notre cas ajouter un nouveau type de pi\xe8ce de th\xe9\xe2tre avec ses propres r\xe8gles de facturation et volume de cr\xe9dits).","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"L’id\xe9e est de minimiser le nombre d’\xe9l\xe9ments qui seront chang\xe9s quand on fera notre changement."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsx)(s.p,{children:"On commence par cr\xe9er le calculateur sans qu’il ne fasse rien :"}),"\n",(0,o.jsx)(s.div,{"data-rehype-pretty-code-fragment":"",children:(0,o.jsx)(s.pre,{"data-language":"typescript","data-theme":"default",children:(0,o.jsxs)(s.code,{"data-language":"typescript","data-theme":"default",children:[(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"enrichPerformance"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(aPerformance) {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"calculator"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"new"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"PerformanceCalculator"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(aPerformance);"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// ..."})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n",(0,o.jsx)(s.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"class"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"PerformanceCalculator"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"constructor"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(aPerformance) {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"this"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".performance "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" aPerformance;"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  }"})}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})})}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsx)(s.p,{children:"Ensuite, pour plus de clart\xe9, on d\xe9place les informations des pi\xe8ces :"}),"\n",(0,o.jsx)(s.div,{"data-rehype-pretty-code-fragment":"",children:(0,o.jsx)(s.pre,{"data-language":"typescript","data-theme":"default",children:(0,o.jsxs)(s.code,{"data-language":"typescript","data-theme":"default",children:[(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"enrichPerformance"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(aPerformance) {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"calculator"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"new"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"PerformanceCalculator"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    aPerformance"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"playFor"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(aPerformance)"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  );"})}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// ..."})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n",(0,o.jsx)(s.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"class"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"PerformanceCalculator"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"constructor"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(aPerformance"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" aPlay) {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"this"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".performance "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" aPerformance;"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"this"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".play "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" aPlay;"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  }"})}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsx)(s.p,{children:(0,o.jsx)(s.strong,{children:"9 - On va d\xe9placer les fonctions de calcul dans le calculateur"})}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["On va d’abord d\xe9placer ",(0,o.jsx)(s.em,{children:"amountFor"})," dans le calculateur.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["Pour \xe7a on commence par utiliser ",(0,o.jsx)(s.strong,{children:"Move Function"})," et copier le code dans un getter, et utiliser les variables d’instance ",(0,o.jsx)(s.code,{children:"this.play"})," et ",(0,o.jsx)(s.code,{children:"this.performance"})," :","\n",(0,o.jsx)(s.div,{"data-rehype-pretty-code-fragment":"",children:(0,o.jsx)(s.pre,{"data-language":"typescript","data-theme":"default",children:(0,o.jsxs)(s.code,{"data-language":"typescript","data-theme":"default",children:[(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"get "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"amount"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"() {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"switch"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ("}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"this"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"."}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"play"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".type) {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"case"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"tragedy"'}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:":"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    thisAmount "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"40000"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ("}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"this"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"."}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"performance"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".audience "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:">"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"30"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:") {"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"//..."})}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})})}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["On va ensuite instancier le calculateur et utiliser le getter ",(0,o.jsx)(s.em,{children:"amount"})," dans ",(0,o.jsx)(s.em,{children:"amountFor"}),", pour tester que jusque l\xe0 les tests passent.","\n",(0,o.jsx)(s.div,{"data-rehype-pretty-code-fragment":"",children:(0,o.jsx)(s.pre,{"data-language":"typescript","data-theme":"default",children:(0,o.jsxs)(s.code,{"data-language":"typescript","data-theme":"default",children:[(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"amountFor"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(aPerformance) {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"new"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"PerformanceCalculator"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(aPerformance"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"playFor"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(aPerformance))"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    .amount;"})}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})})}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["Enfin on va utiliser ",(0,o.jsx)(s.strong,{children:(0,o.jsx)(s.a,{href:"#inline-function",children:"Inline Function"})})," pour \xe9liminer ",(0,o.jsx)(s.em,{children:"amountFor"})," et utiliser ",(0,o.jsx)(s.code,{children:"calculator.amount"})," \xe0 la place."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["On fait la m\xeame chose pour ",(0,o.jsx)(s.em,{children:"volumeCreditsFor"}),", pour se retrouver \xe0 utiliser ",(0,o.jsx)(s.code,{children:"calculator.volumeCredits"}),"."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsx)(s.p,{children:(0,o.jsx)(s.strong,{children:"10 - On va rendre le calculateur polymorphe"})}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:["On va commencer par utiliser ",(0,o.jsx)(s.strong,{children:"Replace Type Code with Subclasses"})," pour \xe7a."]}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:["Pour obtenir la bonne classe, on va utiliser ",(0,o.jsx)(s.strong,{children:"Replace Constructor with Factory Function"})," :"]}),"\n",(0,o.jsx)(s.div,{"data-rehype-pretty-code-fragment":"",children:(0,o.jsx)(s.pre,{"data-language":"typescript","data-theme":"default",children:(0,o.jsxs)(s.code,{"data-language":"typescript","data-theme":"default",children:[(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"enrichPerformance"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(aPerformance) {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"calculator"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"createPerformanceCalculator"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    aPerformance"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"playFor"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(aPerformance)"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  );"})}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"//..."})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n",(0,o.jsx)(s.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"createPerformanceCalculator"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(aPerformance"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" aPlay) {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"switch"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ("}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"aPlay"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".type) {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"case"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"tragedy"'}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:":"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"TragedyCalculator"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(aPerformance"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" aPlay);"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"case"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"comedy"'}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:":"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"ComedyCalculator"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(aPerformance"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" aPlay);"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"default"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:":"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"throw"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"new"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"Error"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"`Unknown type: "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"${"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"aPlay"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".type"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"}"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"`"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:");"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  }"})}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n",(0,o.jsx)(s.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"class"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"TragedyCalculator"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"extends"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"PerformanceCalculator"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {}"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"class"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"ComedyCalculator"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"extends"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"PerformanceCalculator"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {}"})]})]})})}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:["On peut maintenant utiliser ",(0,o.jsx)(s.strong,{children:"Replace Conditional with Polymorphism"})," pour d\xe9placer les fonctions de calcul dans les classes filles."]}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["On peut cr\xe9er un getter du m\xeame nom (",(0,o.jsx)(s.em,{children:"amount"}),") dans ",(0,o.jsx)(s.em,{children:"TragedyCalculator"})," par exemple, pour y d\xe9placer le code li\xe9 \xe0 la facturation des trag\xe9dies."]}),"\n",(0,o.jsx)(s.li,{children:"Puis on le fait pour la facturation des com\xe9dies."}),"\n",(0,o.jsxs)(s.li,{children:["On peut alors supprimer ",(0,o.jsx)(s.code,{children:"get amount()"})," de ",(0,o.jsx)(s.em,{children:"PerformanceCalculator"}),". Ou alors le laisser et y throw une erreur indiquant que la fonctionnalit\xe9 est d\xe9l\xe9gu\xe9e aux classes filles."]}),"\n",(0,o.jsxs)(s.li,{children:["On peut faire pareil avec les volumes de cr\xe9dits. Pour celui-l\xe0 on pourra laisser le cas le plus courant (attribuer des cr\xe9dits si l’auditoire est sup\xe9rieur \xe0 30 personnes) dans ",(0,o.jsx)(s.em,{children:"PerformanceCalculator"}),", et ne surcharger que pour ",(0,o.jsx)(s.em,{children:"ComedyCalculator"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:["Comme souvent, ",(0,o.jsx)(s.strong,{children:"les premi\xe8res phases"})," du refactoring permettent de ",(0,o.jsx)(s.strong,{children:"comprendre"})," ce que fait le code en le clarifiant. On peut ensuite r\xe9injecter cette compr\xe9hension dans la suite des refactorings pour le faire aller dans le sens qu’on veut."]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:["Les ",(0,o.jsx)(s.strong,{children:"petites \xe9tapes"})," sont \xe9tonnantes au premier abord, mais cette m\xe9thode est vraiment efficace, et permet d’avancer sereinement et rapidement pour faire au final des refactorings importants."]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(s.h2,{id:"2---principes-du-refactoring",children:"2 - Principes du refactoring"}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["L’auteur propose une d\xe9finition plus restreinte du refactoring que ce qu’on entend habituellement : il s’agit pour lui d’une ",(0,o.jsx)(s.strong,{children:"succession de petits changements qui permettent de rendre le code plus facile \xe0 comprendre et \xe0 changer, sans changer son comportement"}),".","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"Comme ce sont de petits changements ind\xe9pendants, on peut arr\xeater \xe0 tout moment en gardant le code fonctionnel."}),"\n",(0,o.jsxs)(s.li,{children:["Il propose ",(0,o.jsx)(s.em,{children:"restructuration"})," (restructuring) comme mot plus g\xe9n\xe9ral pour d\xe9signer le fait de r\xe9organiser le code, le refactoring \xe9tant une forme particuli\xe8re de restructuration."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["Les d\xe9veloppeurs ont ",(0,o.jsx)(s.strong,{children:"deux casquettes"})," distinctes qu’ils peuvent porter, une \xe0 la fois : celle d’",(0,o.jsx)(s.strong,{children:"ajout de changements, et celle de refactoring"}),".","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"Il est important d’essayer de garder ces deux casquettes distinctes pour \xeatre efficace dans ce qu’on fait et avancer sereinement."}),"\n",(0,o.jsx)(s.li,{children:"La casquette de changement m\xe8ne normalement \xe0 l’ajout ou \xe0 la modification de tests, alors que la casquette de refactoring ne devrait pas mener \xe0 toucher aux tests."}),"\n",(0,o.jsx)(s.li,{children:"NDLR : \xe0 petite \xe9chelle il s’agit aussi des casquettes qu’on adopte en TDD : red-green avec celle du changement, et refactor avec celle du refactoring."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["Pourquoi faire du refactoring ?","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"Pour conserver et am\xe9liorer l’architecture du logiciel qui se d\xe9lite peu \xe0 peu."}),"\n",(0,o.jsxs)(s.li,{children:["Pour rendre le code plus lisible et compr\xe9hensible.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"On met la connaissance qu’on a au moment o\xf9 on a pass\xe9 du temps sur le code dans le code lui-m\xeame, comme \xe7a on peut nous-m\xeames l’oublier sans souci."}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(s.li,{children:"Pour r\xe9v\xe9ler les bugs qui se cachaient dans du code fouilli."}),"\n",(0,o.jsxs)(s.li,{children:["Pour programmer ",(0,o.jsx)(s.strong,{children:"plus rapidement"}),".","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"Si on met en place du code bien structur\xe9 et compr\xe9hensible, on pourra s’appuyer sur le code existant pour coder plus vite de nouvelles features."}),"\n",(0,o.jsx)(s.li,{children:"Cette hypoth\xe8se est bas\xe9e sur l’exp\xe9rience de Fowler et celle de centaines de programmeurs qu’il conna\xeet."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["Quand faire du refactoring ?","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["La ",(0,o.jsx)(s.strong,{children:"r\xe8gle de trois"})," : on fait quelque chose une fois, la 2\xe8me fois qu’on le fait on laisse passer, la troisi\xe8me fois on fait un refactoring."]}),"\n",(0,o.jsxs)(s.li,{children:["Le meilleur moment est le ",(0,o.jsx)(s.strong,{children:"refactoring pr\xe9paratoire"})," : juste avant de faire une modification, on remanie le code pour rendre cette modification plus facile.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"\xc7a peut \xeatre un refactoring de compr\xe9hension, ou un refactoring de ramassage d’ordures quand on se rend compte que le code est mal structur\xe9 pour ce qu’on veut en faire."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["La plupart des refactorings doivent \xeatre ",(0,o.jsx)(s.strong,{children:"opportunistes"}),", c’est-\xe0-dire s’int\xe9grer au flux habituel d’ajout de fonctionnalit\xe9s ou de correction de bugs.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["On peut parfois aussi faire des refactorings ",(0,o.jsx)(s.strong,{children:"planifi\xe9s"})," si on a vraiment n\xe9glig\xe9 le code ou qu’on tombe sur quelque chose de sp\xe9cifique qui le n\xe9cessite."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["Le refactoring est aussi ",(0,o.jsx)(s.strong,{children:"n\xe9cessaire pour le code qui est d\xe9j\xe0 de bonne qualit\xe9"}),", parce qu’il ne s’agit d’adapter en permanence le code \xe0 notre compr\xe9hension actuelle du syst\xe8me, et celle-ci varie tout le temps."]}),"\n",(0,o.jsxs)(s.li,{children:["L’id\xe9e de s\xe9parer les features et les refactorings dans des features s\xe9par\xe9es n’a pas que des avantages, Fowler est plut\xf4t r\xe9ticent..","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"Elle permet de faire des reviews plus cibl\xe9es, mais d’un autre c\xf4t\xe9 le refactoring est souvent li\xe9 au contexte du changement qu’il accompagne, et on risque d’avoir plus de mal \xe0 le comprendre et \xe0 le justifier isol\xe9ment."}),"\n",(0,o.jsxs)(s.li,{children:["NDLR : ",(0,o.jsx)(s.a,{href:"https://www.youtube.com/watch?v=BFFY9Zor6zw",children:"Kent Beck a r\xe9cemment"})," conseill\xe9 de faire des PRs s\xe9par\xe9es avec de petites granularit\xe9s pour pouvoir choisir le moment o\xf9 on fait des refactorings et fournir des fonctionnalit\xe9s r\xe9guli\xe8res aux personnes qui attendent."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["On a parfois besoin de ",(0,o.jsx)(s.strong,{children:"gros refactorings"}),", par exemple pour remplacer une librairie. Dans ce cas, l'auteur conseille de ",(0,o.jsx)(s.strong,{children:"proc\xe9der petit \xe0 petit"})," quand m\xeame.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["Pour la librairie, on peut mettre en place une abstraction devant la librairie actuelle, et remplacer les fonctionnalit\xe9s derri\xe8re l’abstraction petit \xe0 petit. On appelle \xe7a ",(0,o.jsx)(s.em,{children:"Branch By Abstraction"}),"."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["Le refactoring est aussi utile pendant les ",(0,o.jsx)(s.strong,{children:"code reviews"})," : on retravaille le code pour comprendre plus en profondeur ce que la personne a fait, et pour avoir des id\xe9es d’am\xe9lioration qu’on pourra mettre en place imm\xe9diatement.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["Ca implique de faire la code review ",(0,o.jsx)(s.strong,{children:"en pr\xe9sence de la personne qui a fait la PR"}),". Faire des Code reviews sans la personne ne fonctionne de toute fa\xe7on pas tr\xe8s bien selon Fowler."]}),"\n",(0,o.jsx)(s.li,{children:"La conclusion logique de la pratique est le pair programming."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["Quand ne pas faire de refactoring :","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"Quand on tombe sur du code qui part dans tous les sens mais qu’on n’a pas besoin de le modifier."}),"\n",(0,o.jsx)(s.li,{children:"Quand il est pr\xe9f\xe9rable de r\xe9\xe9crire le code plut\xf4t que de le remanier. Ce genre de d\xe9cision se fait avec l’exp\xe9rience."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["Que dire aux managers pour le refactoring ?","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"Les managers qui ont une bonne compr\xe9hension de la technique vont de toute fa\xe7on encourager le refactoring parce qu’ils sauront que \xe7a permet de rester productif."}),"\n",(0,o.jsxs)(s.li,{children:["Pour ceux qui n’ont pas de bonne comp\xe9tences techniques, le conseil controvers\xe9 de Fowler est de ",(0,o.jsx)(s.strong,{children:"ne pas leur dire qu’on en fait"}),".","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"Nous sommes les professionnels du d\xe9veloppement, nous sommes pay\xe9s pour notre expertise \xe0 coder vite, et le refactoring nous permet justement de coder vite."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["De mani\xe8re g\xe9n\xe9rale, et y compris aupr\xe8s des d\xe9veloppeurs, il ne faut pas justifier le refactoring par “la beaut\xe9 du code” ou “les bonnes pratiques”, mais par le crit\xe8re \xe9conomique qui met tout le monde d’accord : ",(0,o.jsx)(s.strong,{children:"\xe7a permet d’aller plus vite"}),"."]}),"\n",(0,o.jsxs)(s.li,{children:["Il vaut mieux \xe9viter des granularit\xe9s trop fines pour ce qui est de la propri\xe9t\xe9 du code, notamment au sein d’une \xe9quipe : chaque membre de l’\xe9quipe devrait pouvoir modifier toute la codebase pour pouvoir faire des refactorings qui toucheraient \xe9ventuellement jusque ces endroits-l\xe0.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"On peut \xe9tendre \xe7a entre les \xe9quipes o\xf9 n’importe qui de l’entreprise pourrait faire un PR chez la codebase d’une autre \xe9quipe."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["L’utilisation de ",(0,o.jsx)(s.em,{children:"feature branches"})," est probl\xe9matique par rapport aux conflits de mege, et en particulier par rapport aux refactorings qui vont provoquer beaucoup de conflits.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["La pratique du refactoring va de pair avec la Continuous Integration (CI), aussi appel\xe9e trunk-based development, qui consiste \xe0 ",(0,o.jsx)(s.strong,{children:"int\xe9grer au moins une fois par"})," jour son travail sur le branche principale.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["Les deux pratiques font partie de l’",(0,o.jsx)(s.em,{children:"Extreme Programming"}),"."]}),"\n",(0,o.jsxs)(s.li,{children:["A noter que la CI est prouv\xe9e comme plus efficace que les autres pratiques d’int\xe9gration (cf. le livre ",(0,o.jsx)(s.strong,{children:(0,o.jsx)(s.em,{children:"Accelerate"})}),")."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["Pour faire des refactorings, il faut soit des ",(0,o.jsx)(s.strong,{children:"tests"})," qui assurent que le comportement n’est pas chang\xe9, soit utiliser des outils qui font des ",(0,o.jsx)(s.strong,{children:"refactorings automatiquement"})," (par exemple renommer une variable ou extraire une fonction).","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["Dans ",(0,o.jsx)(s.strong,{children:(0,o.jsx)(s.em,{children:"Working Effectively with Legacy Code"})}),", Michael Feathers d\xe9crit comment ajouter des tests \xe0 du code legacy : il faut trouver des points d’entr\xe9e o\xf9 ins\xe9rer des tests, et pour \xe7a il faut prendre des risques en faisant du refactoring."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["Pour ce qui est du ",(0,o.jsx)(s.strong,{children:"refactoring de bases de donn\xe9es"}),", il faut aussi y aller par petits pas, en cr\xe9ant de petites migrations successives.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["Il y a un livre \xe0 ce sujet : ",(0,o.jsx)(s.strong,{children:(0,o.jsx)(s.em,{children:"Refactoring Databases"})}),"."]}),"\n",(0,o.jsxs)(s.li,{children:["Une bonne pratique est le ",(0,o.jsx)(s.strong,{children:"changement parall\xe8le"})," (aussi appel\xe9 expand-contract) o\xf9 on va d’abord cr\xe9er la nouvelle structure, puis l’alimenter avec l’ancienne, puis migrer tout petit \xe0 petit pour utiliser la nouvelle. Et finalement supprimer l’ancienne."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["Le refactoring implique d’adopter une ",(0,o.jsx)(s.strong,{children:"approche incr\xe9mentale de l’architecture"}),".","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["On appelle \xe7a aussi ",(0,o.jsx)(s.strong,{children:"YAGNI"})," (you aren’t going to need it) : il s’agit de ne pas rendre le code inutilement flexible pour plus tard “au cas o\xf9”.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"Par exemple, ne pas ajouter des param\xe8tres non utilis\xe9s \xe0 une fonction, au cas o\xf9 on en aurait besoin plus tard. On les ajoutera avec du refactoring quand on en aura effectivement besoin."}),"\n",(0,o.jsx)(s.li,{children:"Souvent le besoin imagin\xe9 ne se r\xe9alise pas, ou pas comme on l’avait imagin\xe9."}),"\n",(0,o.jsx)(s.li,{children:"\xc7a a bien s\xfbr des limites : parfois un refactoring sera beaucoup plus co\xfbteux plus tard. Dans ce cas, on peut l’envisager tout de suite. Mais ce n'est pas si courant."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["Cette approche de l’architecture est aussi \xe9tudi\xe9e sous le nom d’",(0,o.jsx)(s.strong,{children:"evolutionary architecture"}),"."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["Le refactoring fait partie d’un ensemble de techniques interd\xe9pendantes et coh\xe9rentes qui permet l’agilit\xe9. Elles sont regroup\xe9es au sein de l’",(0,o.jsx)(s.strong,{children:"Extreme Programming"}),".","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"Parmi ces techniques il y a notamment : le refactoring, l’int\xe9gration continue (CI), la livraison continue (CD), YAGNI, et les tests automatis\xe9s."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["Il y a 3 mani\xe8res d’aborder la question de la ",(0,o.jsx)(s.strong,{children:"performance"})," :","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["La 1\xe8re est la ",(0,o.jsx)(s.strong,{children:"budg\xe9tisation du temps"})," : au moment de la conception on attribue un budget temps qui ne doit pas \xeatre d\xe9pass\xe9 \xe0 chaque composant.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["C’est utile pour les ",(0,o.jsx)(s.strong,{children:"syst\xe8mes temps r\xe9el"})," comme les simulateurs cardiaques, mais inadapt\xe9 \xe0 des syst\xe8mes web classiques."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["La 2\xe8me est l’",(0,o.jsx)(s.strong,{children:"attention constante"})," : on essaye de faire attention \xe0 la performance sur tout le code qu’on \xe9crit.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"Le probl\xe8me c’est qu’en g\xe9n\xe9ral l’essentiel du temps d’ex\xe9cution des programmes se concentre sur tr\xe8s peu de code. Et on passe 90% du temps \xe0 optimiser des choses qui n’ont aucun impact."}),"\n",(0,o.jsx)(s.li,{children:"Un autre probl\xe8me c’est qu’on a en g\xe9n\xe9ral une mauvaise id\xe9e de la mani\xe8re dont se comporte le compilateur, le runtime, le mat\xe9riel etc. et on optimise des choses \xe0 tort."}),"\n",(0,o.jsxs)(s.li,{children:["Cette solution m\xe8ne \xe0 perdre beaucoup de temps \xe0 faire des ",(0,o.jsx)(s.strong,{children:"optimisations inutiles"}),", et \xe0 obtenir du ",(0,o.jsx)(s.strong,{children:"code peu maintenable"}),"."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["La 3\xe8me m\xe9thode consiste \xe0 ",(0,o.jsx)(s.strong,{children:"s\xe9parer l’optimisation de performance dans une phase \xe0 part"})," : on code sans prendre en compte la performance, puis on passe du temps d\xe9di\xe9 \xe0 l’am\xe9liorer.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"On utilise un profiler pour rep\xe9rer les endroits du code qui consomment le plus (de temps, de m\xe9moire etc.), et on se concentre sur \xe7a seulement."}),"\n",(0,o.jsx)(s.li,{children:"On proc\xe8de l\xe0 aussi it\xe9rativement par petites touches, en annulant ce qu’on a fait si \xe7a n’am\xe9liore pas."}),"\n",(0,o.jsx)(s.li,{children:"Le fait d’avoir du code bien refactor\xe9 permet de plus facilement comprendre ce qui se passe, et aide donc \xe0 optimiser."}),"\n",(0,o.jsxs)(s.li,{children:["Cette approche est ",(0,o.jsx)(s.strong,{children:"la plus efficace"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["Quelques livres int\xe9ressants sur le refactoring :","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:(0,o.jsx)(s.em,{children:"Refactoring Workbook"})})," de Bill Wake : un livre avec des exercices pour mettre en application le refactoring."]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:(0,o.jsx)(s.em,{children:"Refactoring to Patterns"})})," de Josh Kerievsky : comment appliquer le refactoring en utilisant les design patterns du gang of four."]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:(0,o.jsx)(s.em,{children:"Refactoring Databases"})})," de Scott Ambler et Pramod Sadalage et ",(0,o.jsx)(s.strong,{children:(0,o.jsx)(s.em,{children:"Refactoring HTML"})})," de Elliotte Rusty : des livres appliquant le refactoring \xe0 des domaines sp\xe9cifiques."]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:(0,o.jsx)(s.em,{children:"Working Effectively with Legacy Code"})})," de Michael Feathers : comment faire du refactoring sur du code avec peu ou pas de tests."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(s.h2,{id:"3---quand-le-code-sent-mauvais",children:"3 - Quand le code sent mauvais"}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["On ne peut pas savoir quand un refactoring est n\xe9cessaire mieux que l’intuition d’un programmeur exp\xe9riment\xe9, mais ce chapitre contient une liste de 24 ",(0,o.jsx)(s.strong,{children:"code smells"})," qui devraient au moins nous alerter quand on les croise."]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"1 - Mysterious Name"})," : quand on ne comprend pas un nom de variable ou fonction au premier coup d'œil, il faut la renommer.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"Si on n’arrive pas \xe0 trouver un bon nom, c’est sans doute qu’on a d’autres probl\xe8mes plus profonds avec le code qu’on essaye de nommer."}),"\n",(0,o.jsxs)(s.li,{children:["Parmi les techniques, il y a ",(0,o.jsx)(s.strong,{children:"Change Function Declaration"}),", ",(0,o.jsx)(s.strong,{children:"Rename Function"})," et ",(0,o.jsx)(s.strong,{children:"Rename Field"}),"."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"2 - Duplicated Code"})," : quand on a du code dupliqu\xe9, il faut essayer de le factoriser pour avoir moins d’endroits \xe0 maintenir \xe0 jour \xe0 chaque modification.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["En g\xe9n\xe9ral on va utiliser ",(0,o.jsx)(s.strong,{children:(0,o.jsx)(s.a,{href:"#extract-function",children:"Extract Function"})}),"."]}),"\n",(0,o.jsxs)(s.li,{children:["Si le code dupliqu\xe9 n’est pas tout \xe0 fait identique, on peut d’abord utiliser ",(0,o.jsx)(s.strong,{children:"Slide Statements"})," pour obtenir un morceau de code identique \xe0 factoriser."]}),"\n",(0,o.jsxs)(s.li,{children:["Si le code dupliqu\xe9 se trouve dans des classes filles d’une m\xeame hi\xe9rarchie, on peut la remonter dans la m\xe8re avec ",(0,o.jsx)(s.strong,{children:"Pull Up Method"}),"."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"3 - Long Function"})," : les fonctions courtes sont plus efficaces pour la compr\xe9hension du code.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["L’id\xe9e c’est de nommer les fonctions avec ",(0,o.jsx)(s.strong,{children:"l’intention de leur code"})," plut\xf4t que par ce qu’il fait. A chaque fois qu’on veut commenter, on peut remplacer \xe7a par une fonction qui encapsule le bout de code."]}),"\n",(0,o.jsxs)(s.li,{children:["C’est tout \xe0 fait OK de faire des fonctions qui ne contiennent ",(0,o.jsx)(s.strong,{children:"qu’une ligne"}),", pour peu que le nommage apporte une meilleure information sur l’intention."]}),"\n",(0,o.jsxs)(s.li,{children:["En g\xe9n\xe9ral, on va utiliser ",(0,o.jsx)(s.strong,{children:(0,o.jsx)(s.a,{href:"#extract-function",children:"Extract Function"})}),"."]}),"\n",(0,o.jsxs)(s.li,{children:["Les ",(0,o.jsx)(s.strong,{children:"conditions"})," peuvent \xeatre divis\xe9es avec ",(0,o.jsx)(s.strong,{children:"Decompose Conditional"}),".","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["Un grand switch devrait avoir ses clauses transform\xe9es en un seul appel de fonction avec ",(0,o.jsx)(s.strong,{children:(0,o.jsx)(s.a,{href:"#extract-function",children:"Extract Function"})}),"."]}),"\n",(0,o.jsxs)(s.li,{children:["S’il y a plus d’un switch sur la m\xeame condition, alors il faut appliquer ",(0,o.jsx)(s.strong,{children:"Replace Conditional with Polymorphism"}),"."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["Les ",(0,o.jsx)(s.strong,{children:"boucles"})," peuvent \xeatre extraites dans leur propre fonction.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["Si on a du mal \xe0 nommer la fonction, alors on peut appliquer d’abord ",(0,o.jsx)(s.strong,{children:"Split Loop"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"4 - Long Parameter List"})," : trop de param\xe8tres porte \xe0 confusion, il faut essayer de les \xe9liminer.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["Si on peut obtenir un param\xe8tre \xe0 partir d’un autre, alors on peut appliquer ",(0,o.jsx)(s.strong,{children:"Replace Temp with Query"})," pour l’\xe9liminer."]}),"\n",(0,o.jsxs)(s.li,{children:["Si plusieurs param\xe8tres sont toujours ensemble, on peut les combiner avec ",(0,o.jsx)(s.strong,{children:"Introduce Parameter Object"}),"."]}),"\n",(0,o.jsxs)(s.li,{children:["Si un argument est utilis\xe9 pour choisir une logique dans la fonction, on peut diviser la logique en plusieurs fonctions avec ",(0,o.jsx)(s.strong,{children:"Remove Flag Argument"}),"."]}),"\n",(0,o.jsxs)(s.li,{children:["On peut aussi regrouper les fonctions qui ont des param\xe8tres communs en classes avec ",(0,o.jsx)(s.strong,{children:"Combien Functions into Class"}),", pour remplacer les param\xe8tres par des champs."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"5 - Global Data"})," : le probl\xe8me des donn\xe9es globales c’est qu’on peut les modifier de n’importe o\xf9, et donc c’est tr\xe8s difficile de suivre ce qui se passe.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["Pour traiter le probl\xe8me, il faut les encapsuler avec ",(0,o.jsx)(s.strong,{children:"Encapsulate Variable"}),"."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"6 - Mutable Data"})," : le fait que les structures soient mutables fait qu’on peut changer une structure quelque part, et provoquer un bug ailleurs sans s’en rendre compte.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"La recherche de l'immutabilit\xe9 vient de la programmation fonctionnelle."}),"\n",(0,o.jsxs)(s.li,{children:["On peut utiliser ",(0,o.jsx)(s.strong,{children:"Encapsulate Variable"})," pour s’assurer qu’on modifie la structure \xe0 partir de petites fonctions."]}),"\n",(0,o.jsxs)(s.li,{children:["Si une variable est mise \xe0 jour pour stocker plusieurs choses, on peut utiliser ",(0,o.jsx)(s.strong,{children:"Split Variable"})," pour rendre ces updates moins risqu\xe9es."]}),"\n",(0,o.jsxs)(s.li,{children:["Il faut essayer de garder la logique qui n’a pas de side effects et le code qui modifie la structure s\xe9par\xe9s, avec ",(0,o.jsx)(s.strong,{children:"Slide Statements"})," et ",(0,o.jsx)(s.strong,{children:(0,o.jsx)(s.a,{href:"#extract-function",children:"Extract Function"})}),". Et dans les APIs, on peut utiliser ",(0,o.jsx)(s.strong,{children:"Separate Query from Modifier"})," pour que l’appelant fasse des queries sans danger."]}),"\n",(0,o.jsxs)(s.li,{children:["D\xe8s que c’est possible, il faut utiliser ",(0,o.jsx)(s.strong,{children:"Remove Setting Method"})," pour enlever les setters."]}),"\n",(0,o.jsxs)(s.li,{children:["Les donn\xe9es mutables qui sont calcul\xe9es ailleurs sont sources de bugs, il faut les remplacer par ",(0,o.jsx)(s.strong,{children:"Replace Derived Variable with Query"}),"."]}),"\n",(0,o.jsxs)(s.li,{children:["Il faut essayer de limiter le scope du code qui a acc\xe8s aux variables mutables. Par exemple avec ",(0,o.jsx)(s.strong,{children:"Combine Functions into Class"}),", ou ",(0,o.jsx)(s.strong,{children:"Combine Functions into Transform"}),"."]}),"\n",(0,o.jsxs)(s.li,{children:["Si une variable contient d\xe9j\xe0 une structure avec d’autres donn\xe9es, il vaut mieux remplacer la structure enti\xe8re d’un coup, plut\xf4t que de modifier la variable, avec ",(0,o.jsx)(s.strong,{children:"Change Reference to Value"}),"."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"7 - Divergent Change"})," : quand on a un module qui doit \xeatre modifi\xe9 pour plusieurs raisons, on est face \xe0 des changements divergents.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"Par exemple si on se dit “Je devrai modifier ces trois fonctions si j’ajoute une nouvelle base de donn\xe9es, et ces quatre fonctions si j’ajoute un nouvel instrument financier” : les bases de donn\xe9es et les instruments financiers sont deux contextes diff\xe9rents qu’il vaut mieux traiter s\xe9par\xe9ment."}),"\n",(0,o.jsxs)(s.li,{children:["Si les deux contextes forment deux phases (par exemple il faut obtenir les infos de la base de donn\xe9es, puis appliquer un instrument financier), alors on peut utiliser ",(0,o.jsx)(s.strong,{children:"Split Phase"})," pour s\xe9parer les deux avec une structure de donn\xe9es."]}),"\n",(0,o.jsxs)(s.li,{children:["Sinon on peut utiliser ",(0,o.jsx)(s.strong,{children:(0,o.jsx)(s.a,{href:"#extract-function",children:"Extract Function"})})," pour les s\xe9parer dans plusieurs fonctions."]}),"\n",(0,o.jsxs)(s.li,{children:["Et si c’est des classes : ",(0,o.jsx)(s.strong,{children:"Extract Class"}),"."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"8 - Shotgun Surgery"})," : c’est l’inverse du Divergent Change, on a une fonctionnalit\xe9 qui est dispers\xe9e \xe0 plusieurs endroits qu’il faut \xe0 chaque fois aller modifier.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["On peut utiliser ",(0,o.jsx)(s.strong,{children:"Move Function"})," et ",(0,o.jsx)(s.strong,{children:"Move Field"})," pour replacer le code au m\xeame endroit."]}),"\n",(0,o.jsxs)(s.li,{children:["Si on a des fonctions qui op\xe8rent sur les m\xeames donn\xe9es, on peut les associer avec ",(0,o.jsx)(s.strong,{children:"Combien Functions into Class"}),"."]}),"\n",(0,o.jsxs)(s.li,{children:["On peut aussi combiner le code \xe9parpill\xe9 dans une grande fonction ou classe (avec ",(0,o.jsx)(s.strong,{children:(0,o.jsx)(s.a,{href:"#inline-function",children:"Inline Function"})})," et ",(0,o.jsx)(s.strong,{children:"Inline Class"}),") avant de s\xe9parer \xe7a en plus petites fonctions."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"9 - Feature Envy"})," : on essaye en g\xe9n\xe9ral d’avoir des modules \xe0 l’int\xe9rieur desquels il y a beaucoup de communication, et entre lesquels il y en a peu. On parle de feature envy quand un module communique plus avec du code ‘un module voisin qu’avec le module o\xf9 il est.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["En g\xe9n\xe9ral on va utiliser ",(0,o.jsx)(s.strong,{children:"Move Function"}),", parfois pr\xe9c\xe9d\xe9 d’",(0,o.jsx)(s.strong,{children:(0,o.jsx)(s.a,{href:"#extract-function",children:"Extract Function"})})," si seule une partie de la fonction a besoin de changer d’endroit."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"10 - Data Clumps"})," : quand on a un groupe de donn\xe9es qui se retrouvent toujours ensemble, c’est qu’elles doivent peut-\xeatre rejoindre une m\xeame structure.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["On va d’abord chercher o\xf9 ces donn\xe9es apparaissent sous forme de champs pour les extraire dans une nouvelle classe avec ",(0,o.jsx)(s.strong,{children:"Extract Class"}),".","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"On parle bien d’extraire dans une classe et pas dans une simple structure, parce que \xe7a va permettre ensuite d’y ajouter du comportement propre \xe0 ces donn\xe9es, typiquement quand on a des Feature Envies."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["Au niveau des param\xe8tres des fonctions on va alors pouvoir utiliser ",(0,o.jsx)(s.strong,{children:"Introduce Parameter Object"})," et ",(0,o.jsx)(s.strong,{children:"Preserve Whole Object"}),"."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"11 - Primitive Obsession"})," : il s’agit d’utiliser des Value Objects \xe0 la place des types primitifs comme number ou string.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"Exemple : un num\xe9ro de t\xe9l\xe9phone doit \xeatre valid\xe9, et correctement affich\xe9."}),"\n",(0,o.jsxs)(s.li,{children:["La r\xe8gle typique c’est ",(0,o.jsx)(s.strong,{children:"Replace Primitive with Object"}),"."]}),"\n",(0,o.jsxs)(s.li,{children:["Si le type primitif est impliqu\xe9 dans une structure conditionnelle, on peut encapsuler les conditions dans une hi\xe9rarchie de classes avec ",(0,o.jsx)(s.strong,{children:"Replace Type Code with Subclasses"})," puis ",(0,o.jsx)(s.strong,{children:"Replace Conditionals with Polymorphism"}),"."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"12 - Repeated Switches"})," : on rep\xe8re les switchs portant sur la m\xeame condition, et on les remplace par des classes.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["Il s’agit d’utiliser ",(0,o.jsx)(s.strong,{children:"Replace Conditional with Polymorphism"}),"."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"13 - Loops"})," : les fonctions issues de la programmation fonctionnelle (map, filter, reduce) permettent de voir plus rapidement les \xe9l\xe9ments qui sont inclus et ce qui est fait avec eux, par rapport \xe0 des boucles.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["On peut remplacer les boucles par des pipelines avec ",(0,o.jsx)(s.strong,{children:"Replace Loop with Pipeline"}),"."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"14 - Lazy Element"})," : parfois certaines classes ou fonctions sont inutiles.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"Par exemple une fonction dont le corps se lit de la m\xeame mani\xe8re que son nom, ou une classe qui n’a qu’une m\xe9thode et qui pourrait \xeatre une fonction."}),"\n",(0,o.jsxs)(s.li,{children:["On peut les \xe9liminer avec ",(0,o.jsx)(s.strong,{children:(0,o.jsx)(s.a,{href:"#inline-function",children:"Inline Function"})})," ou ",(0,o.jsx)(s.strong,{children:"Inline Class"}),"."]}),"\n",(0,o.jsxs)(s.li,{children:["Dans le cas o\xf9 on veut r\xe9duire une hi\xe9rarchie de classe, on peut utiliser ",(0,o.jsx)(s.strong,{children:"Collapse Hierarchy"}),"."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"15 - Speculative Generality"})," : quand on ajoute des m\xe9canismes de flexibilit\xe9 pour plus tard, au cas o\xf9 il y en aurait besoin. Il faut s’en d\xe9barrasser parce que YAGNI.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["On peut se d\xe9barrasser de classes qui ne font pas grand chose avec ",(0,o.jsx)(s.strong,{children:"Collapse Hierarchy"}),"."]}),"\n",(0,o.jsxs)(s.li,{children:["Les d\xe9l\xe9gations inutiles peuvent \xeatre \xe9limin\xe9es avec ",(0,o.jsx)(s.strong,{children:(0,o.jsx)(s.a,{href:"#inline-function",children:"Inline Function"})})," et ",(0,o.jsx)(s.strong,{children:"Inline Class"}),"."]}),"\n",(0,o.jsxs)(s.li,{children:["Les param\xe8tres inutilis\xe9s par les fonctions peuvent \xeatre enlev\xe9s avec ",(0,o.jsx)(s.strong,{children:"Change Function Declaration"}),"."]}),"\n",(0,o.jsxs)(s.li,{children:["Si les seuls utilisateurs d’une fonction sont des tests, il faut les supprimer, puis appliquer ",(0,o.jsx)(s.strong,{children:"Remove Dead Code"}),"."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"16 - Temporary Field"})," : quand une classe contient un champ utilis\xe9 seulement dans certains cas, \xe7a rend le code plus difficile \xe0 comprendre.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["On peut utiliser ",(0,o.jsx)(s.strong,{children:"Extract Class"})," puis ",(0,o.jsx)(s.strong,{children:"Move Function"})," pour d\xe9placer le code qui utilise le champ qui est \xe0 part."]}),"\n",(0,o.jsxs)(s.li,{children:["Il se peut aussi qu’on puisse r\xe9duire le probl\xe8me au fait de traiter le cas o\xf9 les variables ne sont pas valides en utilisant ",(0,o.jsx)(s.strong,{children:"Introduce Special Case"}),"."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"17 - Message Chains"})," : il s’agit de longues cha\xeenes d’appels d’objet en objet pour obtenir quelque chose au bout du compte. Si une des m\xe9thodes d’un des objets de la cha\xeene change, notre appelant doit changer aussi.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["On peut utiliser ",(0,o.jsx)(s.strong,{children:"Hide Delegate"})," sur les objets interm\xe9diaires."]}),"\n",(0,o.jsxs)(s.li,{children:["Une autre solution est de voir si on peut utiliser ",(0,o.jsx)(s.strong,{children:(0,o.jsx)(s.a,{href:"#extract-function",children:"Extract Function"})})," suivi de ",(0,o.jsx)(s.strong,{children:"Move Function"})," pour d\xe9placer l’utilisation de la cha\xeene d’appels plus bas dans la cha\xeene."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"18 - Middle Man"})," : il est normal d’encapsuler et de d\xe9l\xe9guer des choses, mais si une classe d\xe9l\xe8gue la moiti\xe9 de ses m\xe9thodes \xe0 une autre classe, c’est qu’il est peut \xeatre temps de s’interfacer directement avec la classe qui sait ce qui se passe.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["La technique \xe0 utiliser est ",(0,o.jsx)(s.strong,{children:"Remove Middle Man"}),"."]}),"\n",(0,o.jsxs)(s.li,{children:["On peut aussi utiliser ",(0,o.jsx)(s.strong,{children:"Replace Superclass with Delegate"})," ou ",(0,o.jsx)(s.strong,{children:"Replace Subclass with Delegate"})," pour fondre le middle man dans la classe cible."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"19 - Insider Trading"})," : il s’agit de code de modules diff\xe9rents qui communique trop entre eux, et donc un couplage trop important entre modules.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["On peut utiliser ",(0,o.jsx)(s.strong,{children:"Move Function"})," et ",(0,o.jsx)(s.strong,{children:"Move Field"})," pour s\xe9parer le code qui ne devrait pas \xeatre trop coupl\xe9."]}),"\n",(0,o.jsxs)(s.li,{children:["Dans le cas o\xf9 les modules ont des choses en commun, on peut aussi en extraire une classe commune, ou utiliser ",(0,o.jsx)(s.strong,{children:"Hide Delegate"})," pour utiliser un module comme interm\xe9diaire."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"20 - Large Class"})," : une classe avec trop de champs doit \xeatre divis\xe9e en plusieurs classes.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["On peut typiquement rep\xe9rer les noms de variable qui partagent un pr\xe9fixe ou suffixe commun, et utiliser ",(0,o.jsx)(s.strong,{children:"Extract Class"}),", ou encore ",(0,o.jsx)(s.strong,{children:"Extract Superclass"})," ou ",(0,o.jsx)(s.strong,{children:"Replace Type Code with Subclasses"}),"."]}),"\n",(0,o.jsxs)(s.li,{children:["Si la classe a trop de code, on va probablement avoir des duplications. Le mieux est alors de la refactorer en petites fonctions.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"Par exemple pour une classe de 500 lignes, on peut refactorer en m\xe9thodes de 5 \xe0 10 lignes, avec une dizaine de m\xe9thodes de 2 lignes extraites dans une classe \xe0 part."}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(s.li,{children:"Un bon indicateur pour d\xe9couper une classe c’est en regardant le code qui l’utilise, souvent on peut rep\xe9rer des parties dans la classe."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"21 - Alternative Classes with Different Interfaces"})," : \xe7a peut \xeatre int\xe9ressant de pouvoir substituer une classe par une autre. Pour \xe7a il faut faire correspondre leur prototype en les faisant adh\xe9rer \xe0 une m\xeame interface.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["Pour faire correspondre les deux classes, on peut utiliser ",(0,o.jsx)(s.strong,{children:"Change Function Declaration"})," et ",(0,o.jsx)(s.strong,{children:"Move Function"}),"."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"22 - Data Class"})," : les classes qui ont des getters/setters mais peu ou pas de logique sont un signe que la logique n’est pas au bon endroit.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["Leurs champs publics doivent \xeatre encapsul\xe9s avec ",(0,o.jsx)(s.strong,{children:"Encapsulate Record"}),"."]}),"\n",(0,o.jsxs)(s.li,{children:["Les setters pour les m\xe9thodes qui ne doivent pas \xeatre chang\xe9s doivent \xeatre enlev\xe9s avec ",(0,o.jsx)(s.strong,{children:"Remove Setting Method"}),"."]}),"\n",(0,o.jsxs)(s.li,{children:["Ensuite on peut chercher o\xf9 ces getters et setters sont utilis\xe9s, et appliquer ",(0,o.jsx)(s.strong,{children:"Move Function"})," (et au besoin ",(0,o.jsx)(s.strong,{children:(0,o.jsx)(s.a,{href:"#extract-function",children:"Extract Function"})}),") pour d\xe9placer la logique dans la classe qu’on cherche \xe0 enrichir."]}),"\n",(0,o.jsxs)(s.li,{children:["Il y a des exceptions : certaines classes peuvent \xeatre l\xe9gitimes en tant que structure de donn\xe9es, et dans ce cas il n’y a pas besoin de getters et setters. Leurs champs seront immutables et donc n’auront pas besoin d’\xeatre encapsul\xe9s.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["Exemple : la structure de donn\xe9es qui permet de communiquer entre les deux phases quand on utilise ",(0,o.jsx)(s.strong,{children:"Split Phase"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"23 - Refused Bequest"})," : parfois certaines classes filles refusent certaines impl\xe9mentations venant du parent.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"Il ne s’agit pas d’une forte odeur, donc on peut parfois le tol\xe9rer."}),"\n",(0,o.jsxs)(s.li,{children:["Si on veut r\xe9gler le probl\xe8me, on peut utiliser une classe soeur et pousser le code qui ne devrait pas \xeatre partag\xe9 vers elle avec ",(0,o.jsx)(s.strong,{children:"Push Down Method"})," et ",(0,o.jsx)(s.strong,{children:"Push Down Field"}),"."]}),"\n",(0,o.jsxs)(s.li,{children:["Parfois, ce n'est pas l’impl\xe9mentation d’une m\xe9thode, mais l’interface que la classe fille ne veut pas. Dans ce cas l’odeur est beaucoup plus forte et il faut \xe9liminer l’h\xe9ritage pour le remplacer par de la d\xe9l\xe9gation avec ",(0,o.jsx)(s.strong,{children:"Replace Subclass with Delegate"})," ou ",(0,o.jsx)(s.strong,{children:"Replace Superclass with Delegate"}),"."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"24 - Comments"})," : la plupart des commentaires cachent des code smells, et sont inutiles si on les refactore.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["Quand on en rencontre, il faut essayer de voir si on ne peut mieux expliquer ce que fait un bloc de code avec ",(0,o.jsx)(s.strong,{children:(0,o.jsx)(s.a,{href:"#extract-function",children:"Extract Function"})})," et ",(0,o.jsx)(s.strong,{children:"Change Function Declaration"}),". Ou encore d\xe9clarer des r\xe8gles sur l’\xe9tat du syst\xe8me avec ",(0,o.jsx)(s.strong,{children:"Introduce Assertion"}),"."]}),"\n",(0,o.jsx)(s.li,{children:"Si malgr\xe9 \xe7a on a toujours besoin du commentaire, alors c’est qu’il est l\xe9gitime. Il peut servir \xe0 d\xe9crire ce qui se passe, indiquer les endroits o\xf9 on n’est pas s\xfbr, ou encore expliquer pourquoi on a fait quelque chose."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(s.h2,{id:"4---cr\xe9ation-de-tests",children:"4 - Cr\xe9ation de tests"}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["Les tests sont utiles pour le refactoring, mais aussi plus g\xe9n\xe9ralement ils permettent d’\xe9conomiser un ",(0,o.jsx)(s.strong,{children:"temps cons\xe9quent \xe0 d\xe9bugger"}),"."]}),"\n",(0,o.jsxs)(s.li,{children:["Ecrire le ",(0,o.jsx)(s.strong,{children:"test avant le code"})," permet :","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"De mieux se concentrer sur le fonctionnalit\xe9 qu’on veut faire, en s’int\xe9ressant d’abord \xe0 l’interface plut\xf4t qu’\xe0 l’impl\xe9mentation."}),"\n",(0,o.jsx)(s.li,{children:"De savoir quand la fonctionnalit\xe9 est termin\xe9e : quand le test passe."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["Exemple de programme \xe0 tester :","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"On a un plan de production qui doit montrer la production des producteurs class\xe9s par province."}),"\n",(0,o.jsx)(s.li,{children:"Le code est organis\xe9 avec deux classes : Producer qui contient les donn\xe9es du producteur, et Province qui prend des donn\xe9es JSON, et calcule les \xe9l\xe9ments li\xe9s \xe0 la production."}),"\n",(0,o.jsxs)(s.li,{children:["Exemple de test pour le d\xe9ficit de production :","\n",(0,o.jsx)(s.div,{"data-rehype-pretty-code-fragment":"",children:(0,o.jsx)(s.pre,{"data-language":"typescript","data-theme":"default",children:(0,o.jsxs)(s.code,{"data-language":"typescript","data-theme":"default",children:[(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"describe"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"province"'}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" () "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"it"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"shortfall"'}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" () "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"asia"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"new"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"Province"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"sampleProvinceData"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"());"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"expect"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"asia"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".shortfall)"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".toBe"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"5"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:");"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  });"})}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"});"})})]})})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["Concernant la mani\xe8re de ",(0,o.jsx)(s.strong,{children:"nommer les tests"}),", Fowler ne prend pas position mais se contente de dire que certains d\xe9veloppeurs pr\xe9f\xe8rent faire des phrases, et d’autres \xe9crire peu de mots, et que lui \xe9crit suffisamment de mots pour reconna\xeetre les tests quand ils sont en erreur."]}),"\n",(0,o.jsx)(s.li,{children:"Quand on ajoute des tests \xe0 du code non test\xe9 pour le refactorer, on ne peut pas faire la s\xe9quence “red” puis “green”. On peut donc \xe0 la place jouer le test qui marche, puis introduire une erreur dans le code et v\xe9rifier que le test \xe9choue bien comme on l’aurait pens\xe9."}),"\n",(0,o.jsxs)(s.li,{children:["L’auteur conseille d'",(0,o.jsx)(s.strong,{children:"ex\xe9cuter les tests souvent"})," : si on ne fait pas de TDD, les tests du module sur lequel on travaille au moins toutes les 10 minutes, et l’ensemble des tests au moins une fois par jour."]}),"\n",(0,o.jsx)(s.li,{children:"Il ne faut tester que le code qui en vaut la peine. Typiquement, les getters/setters n’ont pas \xe0 \xeatre test\xe9s parce que le risque d’erreur est faible."}),"\n",(0,o.jsxs)(s.li,{children:["Il faut ",(0,o.jsx)(s.strong,{children:"factoriser les r\xe9p\xe9titions"})," dans les tests comme on le fait pour le code de prod."]}),"\n",(0,o.jsxs)(s.li,{children:["Comme pour le code de prod, il faut \xe0 tout prix ",(0,o.jsx)(s.strong,{children:"\xe9viter les variables globales"})," (et y compris si elles sont assign\xe9es dans un ",(0,o.jsx)(s.code,{children:"beforeAll"}),"), et utiliser soit des variables locales aux tests, soit des ",(0,o.jsx)(s.code,{children:"beforeEach"}),"."]}),"\n",(0,o.jsxs)(s.li,{children:["Fowler aime bien avoir un ",(0,o.jsx)(s.strong,{children:"dispositif de test standard"})," pour chaque groupe de tests, avec lequel il faut se familiariser avant de les regarder.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.code,{children:"beforeEach"})," peut \xeatre une convention pour ce dispositif."]}),"\n",(0,o.jsxs)(s.li,{children:["Le ",(0,o.jsx)(s.code,{children:"describe"})," permet de cr\xe9er des groupes de tests o\xf9 il y aura un ",(0,o.jsx)(s.code,{children:"beforeEach"}),". Si notre test ne rentre pas dans le contexte du dispositif, on pourra cr\xe9er un autre bloc avec \xe9ventuellement un autre dispositif."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["Il conseille d’essayer de se ",(0,o.jsx)(s.strong,{children:"limiter \xe0 une assertion par test"}),", sauf si les \xe9l\xe9ments test\xe9s sont \xe9troitement li\xe9s.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"L’argument est que si le test \xe9choue pour un des premiers asserts, on ne saura pas si les autres \xe9chouaient ou non."}),"\n",(0,o.jsx)(s.li,{children:"NDLR : C’est en contradiction avec le conseil de Vladimir Khorikov sur le fait qu’il faille un seul “act”, et qu'au niveau du “assert” on teste toujours toutes les cons\xe9quences."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["Il faut aussi ",(0,o.jsx)(s.strong,{children:"tester les cas aux limites"})," :","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"Si on a une collection, on peut voir ce qui se passe si elle est vide."}),"\n",(0,o.jsx)(s.li,{children:"Si on a un nombre, on peut voir ce qui se passe avec 0 ou un nombre n\xe9gatif."}),"\n",(0,o.jsx)(s.li,{children:"Si on a une cha\xeene, on peut voir ce qui se passe avec la cha\xeene vide."}),"\n",(0,o.jsx)(s.li,{children:"\xc7a nous oblige \xe0 chaque fois \xe0 nous poser la question de savoir si \xe7a a un sens. Par exemple, si le nombre n\xe9gatif n’aurait pas de sens, on peut s’attendre \xe0 une erreur."}),"\n",(0,o.jsx)(s.li,{children:"Il est possible que l’entr\xe9e vienne d’un module d\xe9j\xe0 test\xe9, dans ce cas il n’est pas n\xe9cessaire de tester notre module avec des cas qui ne devraient pas se produire."}),"\n",(0,o.jsxs)(s.li,{children:["Si un cas d’erreur conduit \xe0 une potentielle corruption de donn\xe9es, on peut utiliser ",(0,o.jsx)(s.strong,{children:"Introduce Assertion"})," pour \xe9viter que \xe7a arrive. Il n’y a pas besoin de tester ce genre de cas.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["NDLR : on est sur du ",(0,o.jsx)(s.em,{children:"fail fast"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(s.li,{children:"Quand on a un bug, l’auteur conseille d’abord d’\xe9crire un test qui reproduit le bug, et ensuite de le faire passer au vert."}),"\n",(0,o.jsxs)(s.li,{children:["La bonne quantit\xe9 de tests c’est quand on est ",(0,o.jsx)(s.strong,{children:"suffisamment confiant pour faire du refactoring"})," et savoir que si on introduit un bug, il sera r\xe9v\xe9l\xe9 par les tests."]}),"\n"]}),"\n",(0,o.jsx)(s.h2,{id:"5---pr\xe9sentation-du-catalogue",children:"5 - Pr\xe9sentation du catalogue"}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"Les chapitres suivants pr\xe9sentent un catalogue de techniques de refactoring suffisamment importants pour \xeatre nomm\xe9s et d\xe9crits."}),"\n",(0,o.jsx)(s.li,{children:"Martin Fowler utilise lui-m\xeame le catalogue pour se refamiliariser avec des techniques de refactorings qu’il n’a pas faites depuis longtemps."}),"\n"]}),"\n",(0,o.jsx)(s.h2,{id:"6---premier-ensemble-de-refactorings",children:"6 - Premier ensemble de refactorings"}),"\n",(0,o.jsx)(s.h3,{id:"extract-function",children:"Extract Function"}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsx)(s.p,{children:(0,o.jsx)(s.strong,{children:"Exemple :"})}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsx)(s.p,{children:"Avant :"}),"\n",(0,o.jsx)(s.div,{"data-rehype-pretty-code-fragment":"",children:(0,o.jsx)(s.pre,{"data-language":"javascript","data-theme":"default",children:(0,o.jsxs)(s.code,{"data-language":"javascript","data-theme":"default",children:[(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"printOwig"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(invoices) {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"printBanner"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"();"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"let"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" outstanding "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"calculateOutstanding"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"();"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// display details;"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"console"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".log"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"`name: "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"${"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"invoice"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".customer"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"}"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"`"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:");"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"console"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".log"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"`amount: "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"${"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"outstanding"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"}"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"`"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:");"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})})}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsx)(s.p,{children:"Apr\xe8s :"}),"\n",(0,o.jsx)(s.div,{"data-rehype-pretty-code-fragment":"",children:(0,o.jsx)(s.pre,{"data-language":"javascript","data-theme":"default",children:(0,o.jsxs)(s.code,{"data-language":"javascript","data-theme":"default",children:[(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"printOwing"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(invoice) {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"printBanner"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"();"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"let"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" outstanding "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"calculateOutstanding"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"();"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"printDetails"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(outstanding);"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"printDetails"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(outstanding) {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"console"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".log"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"`name: "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"${"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"invoice"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".customer"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"}"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"`"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:");"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"console"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".log"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"`amount: "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"${"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"outstanding"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"}"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"`"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:");"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  }"})}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsx)(s.p,{children:(0,o.jsx)(s.strong,{children:"\xc9tapes :"})}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.ol,{children:["\n",(0,o.jsxs)(s.li,{children:["On cr\xe9e une nouvelle fonction pour accueillir le code \xe0 extraire, on la nomme correctement, et on ",(0,o.jsx)(s.strong,{children:"copie"})," le code \xe0 extraire dedans."]}),"\n"]}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["Si le langage le supporte (comme JavaScript), on peut extraire la fonction ",(0,o.jsx)(s.strong,{children:"dans la port\xe9e de la premi\xe8re fonction"}),", ne serait-ce que pour visualiser si l’extraction a du sens sans que ce soit co\xfbteux. On pourra la d\xe9placer \xe9ventuellement plus tard."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.ol,{start:"2",children:["\n",(0,o.jsx)(s.li,{children:"Dans le cas o\xf9 la fonction est export\xe9e hors de la port\xe9e de la fonction source, on lui passe toutes les variables dont elle a besoin en param\xe8tre."}),"\n"]}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"Si une variable n’est utilis\xe9e que dans le code extrait, on la d\xe9place dedans."}),"\n",(0,o.jsx)(s.li,{children:"Si une variable utilis\xe9e en dehors est assign\xe9e \xe0 l’int\xe9rieur du code extrait, alors il faut faire en sorte que la fonction extraite la retourne."}),"\n",(0,o.jsxs)(s.li,{children:["Si on a trop de variables assign\xe9es dans le code extrait, on abandonne l’extraction au profit d’abord de ",(0,o.jsx)(s.strong,{children:"Split Variable"})," ou de ",(0,o.jsx)(s.strong,{children:"Replace Temp with Query"}),"."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.ol,{start:"3",children:["\n",(0,o.jsx)(s.li,{children:"On Compile."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.ol,{start:"4",children:["\n",(0,o.jsx)(s.li,{children:"On remplace le code initialement extrait par un appel \xe0 la nouvelle fonction."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.ol,{start:"5",children:["\n",(0,o.jsx)(s.li,{children:"On teste."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.ol,{start:"6",children:["\n",(0,o.jsxs)(s.li,{children:["On recherche d’autres bouts de code similaires au code extrait pour les remplacer par un appel \xe0 la nouvelle fonction avec ",(0,o.jsx)(s.strong,{children:"Replace Inline Code with Function Call"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsx)(s.p,{children:(0,o.jsx)(s.strong,{children:"Th\xe9orie :"})}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["Le bon argument sur pourquoi extraire une fonction est de ",(0,o.jsx)(s.strong,{children:"s\xe9parer l’intention de l’impl\xe9mentation"}),", pour que l’intention saute aux yeux \xe0 la premi\xe8re lecture."]}),"\n",(0,o.jsxs)(s.li,{children:["L’auteur a tendance \xe0 \xe9crire des ",(0,o.jsx)(s.strong,{children:"fonctions courtes"}),", une fonction d\xe9passant une demi-douzaine de lignes commence \xe0 sentir mauvais, et les fonctions d’une ligne ne sont pas rares pour peu qu’elles expriment mieux l’intention."]}),"\n",(0,o.jsxs)(s.li,{children:["La qualit\xe9 du ",(0,o.jsx)(s.strong,{children:"nommage"})," est fondamentale avec les petites fonctions.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"Si on n’arrive pas \xe0 trouver un nom pour la fonction extraite, c’est peut \xeatre un signe que l’extraction est inutile."}),"\n",(0,o.jsx)(s.li,{children:"Il est normal d’extraire, de manipuler le code, puis de se rendre compte que l’extraction \xe9tait inutile. Tant qu’on a appris quelque chose, on n’a pas perdu son temps."}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(s.li,{children:"Typiquement si on a un commentaire qui marque la s\xe9paration d’un bloc de code, c’est une bonne heuristique pour extraire."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(s.h3,{id:"inline-function",children:"Inline Function"}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsx)(s.p,{children:(0,o.jsx)(s.strong,{children:"Exemple :"})}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsx)(s.p,{children:(0,o.jsx)(s.strong,{children:"Avant :"})}),"\n",(0,o.jsx)(s.div,{"data-rehype-pretty-code-fragment":"",children:(0,o.jsx)(s.pre,{"data-language":"typescript","data-theme":"default",children:(0,o.jsxs)(s.code,{"data-language":"typescript","data-theme":"default",children:[(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"getRating"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(driver) {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"moreThanFiveLateDeliveries"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(driver) "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"?"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"2"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n",(0,o.jsx)(s.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"moreThanFiveLateDeliveries"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(driver) {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"driver"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".numberOfLateDeliveries "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:">"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"5"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})})}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsx)(s.p,{children:(0,o.jsx)(s.strong,{children:"Apr\xe8s :"})}),"\n",(0,o.jsx)(s.div,{"data-rehype-pretty-code-fragment":"",children:(0,o.jsx)(s.pre,{"data-language":"typescript","data-theme":"default",children:(0,o.jsxs)(s.code,{"data-language":"typescript","data-theme":"default",children:[(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"getRating"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(driver) {"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"driver"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".numberOfLateDeliveries "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:">"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"5"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"?"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"2"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsx)(s.p,{children:(0,o.jsx)(s.strong,{children:"\xc9tapes :"})}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.ol,{children:["\n",(0,o.jsx)(s.li,{children:"On v\xe9rifie que la fonction n’est pas une m\xe9thode polymorphe."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.ol,{start:"2",children:["\n",(0,o.jsx)(s.li,{children:"On trouve les endroits o\xf9 la fonction est appel\xe9e et on remplace par le corps de la fonction."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.ol,{start:"3",children:["\n",(0,o.jsx)(s.li,{children:"On teste apr\xe8s chaque remplacement."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.ol,{start:"4",children:["\n",(0,o.jsx)(s.li,{children:"On peut supprimer la fonction qui n’est plus appel\xe9e."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsx)(s.p,{children:(0,o.jsx)(s.strong,{children:"Th\xe9orie :"})}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"Les fonctions courtes sont plus lisibles, mais parfois on peut avoir des fonctions qui n’apportent rien, parce que leur contenu est d\xe9j\xe0 clair. Dans ce cas on les enl\xe8ve."}),"\n",(0,o.jsxs)(s.li,{children:["Une autre raison d’enlever les fonctions c’est pour d’abord ",(0,o.jsx)(s.strong,{children:"regrouper le code dans un grand bloc avant de mieux le d\xe9couper"}),"."]}),"\n",(0,o.jsx)(s.li,{children:"Dans le cas o\xf9 on rencontre des difficult\xe9s importantes pour faire l’incorporation, l’auteur conseille de ne pas faire ce refactoring."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(s.h3,{id:"extract-variable",children:"Extract Variable"}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"Exemple :"}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"Avant :"}),"\n",(0,o.jsx)(s.div,{"data-rehype-pretty-code-fragment":"",children:(0,o.jsx)(s.pre,{"data-language":"javascript","data-theme":"default",children:(0,o.jsxs)(s.code,{"data-language":"javascript","data-theme":"default",children:[(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ("})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"order"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".quantity "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"*"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"order"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".itemPrice "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"-"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"Math"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".max"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"order"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".quantity "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"*"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"500"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:") "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"*"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"order"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".itemPrice "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"-"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"0.05"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"+"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"Math"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".min"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"order"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".quantity "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"*"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"order"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".itemPrice "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"*"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"0.1"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"100"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:");"})})]})})}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"Apr\xe8s :"}),"\n",(0,o.jsx)(s.div,{"data-rehype-pretty-code-fragment":"",children:(0,o.jsx)(s.pre,{"data-language":"javascript","data-theme":"default",children:(0,o.jsxs)(s.code,{"data-language":"javascript","data-theme":"default",children:[(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"basePrice"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"order"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".quantity "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"*"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"order"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".itemPrice;"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"quantityDiscount"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"Math"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".max"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"order"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".quantity "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"-"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"500"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:") "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"*"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"order"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".itemPrice "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"*"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"0.05"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"shipping"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"Math"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".min"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(basePrice "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"*"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"0.1"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"100"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:");"})]}),"\n",(0,o.jsxs)(s.span,{className:"line",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" basePrice "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"-"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" quantityDiscount "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"+"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" shipping;"})]}),"\n",(0,o.jsx)(s.span,{className:"line",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"```"})})]})})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"\xc9tapes :"}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.ol,{children:["\n",(0,o.jsx)(s.li,{children:"On v\xe9rifie que l’expression qu’on veut extraire n’a pas de side effects."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.ol,{start:"2",children:["\n",(0,o.jsx)(s.li,{children:"On cr\xe9e une nouvelle variable immutable avec la valeur de l’expression."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.ol,{start:"3",children:["\n",(0,o.jsx)(s.li,{children:"On remplace l’expression d’origine par la nouvelle variable."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.ol,{start:"4",children:["\n",(0,o.jsx)(s.li,{children:"On teste."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"Th\xe9orie :"}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"Ces variables permettent de d\xe9composer le code pour le rendre plus lisible."}),"\n",(0,o.jsxs)(s.li,{children:["Une fois qu’on a choisi le nom, on r\xe9fl\xe9chit au contexte : si c’est un contexte local une variable est tr\xe8s bien, si c’est plus global il vaut mieux une fonction qu’on r\xe9utilisera dans plusieurs endroits avec le m\xeame nom.","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["Typiquement si on est dans une classe, il y a des chances pour que le concept qu’on extrait puisse devenir un membre de la classe (par exemple avec ",(0,o.jsx)(s.code,{children:"get monConcept()"}),")."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]})]})}h.title="string"==typeof j&&j||"Refactoring: Improving the Design of Existing Code",p.context["/books/refactoring"]={Content:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,c.ah)(),e.components);return s?(0,o.jsx)(s,{...e,children:(0,o.jsx)(u,{...e})}):u(e)},pageOpts:h,themeConfig:t.Z}}},function(e){e.O(0,[774,954,888,179],function(){return e(e.s=391)}),_N_E=e.O()}]);